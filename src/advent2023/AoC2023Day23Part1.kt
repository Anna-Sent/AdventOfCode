package advent2023

import utils.Point
import utils.plus

private var result = 0

fun main() {
    result = test(
        """
            #.#####################
            #.......#########...###
            #######.#########.#.###
            ###.....#.>.>.###.#.###
            ###v#####.#v#.###.#.###
            ###.>...#.#.#.....#...#
            ###v###.#.#.#########.#
            ###...#.#.#.......#...#
            #####.#.#.#######.#.###
            #.....#.#.#.......#...#
            #.#####.#.#.#########v#
            #.#...#...#...###...>.#
            #.#.#v#######v###.###v#
            #...#.>.#...>.>.#.###.#
            #####v#.#.###v#.#.###.#
            #.....#...#...#.#.#...#
            #.#########.###.#.#.###
            #...###...#...#...#.###
            ###.###.#.###v#####v###
            #...#...#.#.>.>.#.>.###
            #.###.###.#.###.#.#v###
            #.....###...###...#...#
            #####################.#
    """.trimIndent()
    )
    check(94, result)

    result = test(
        """
            #.###########################################################################################################################################
            #.#...#...#.........#...#...###...###...###...#...###...#.....###...........#.....#...........#...#...###...###...#...#...#.....#...#...#####
            #.#.#.#.#.#.#######.#.#.#.#.###.#.###.#.###.#.#.#.###.#.#.###.###.#########.#.###.#.#########.#.#.#.#.###.#.###.#.#.#.#.#.#.###.#.#.#.#.#####
            #.#.#.#.#.#.#.......#.#...#.#...#.....#.#...#.#.#...#.#.#.#...#...#.........#.#...#.........#...#.#.#.#...#.#...#.#.#.#.#.#...#.#.#...#.....#
            #.#.#v#.#.#.#.#######.#####.#.#########.#.###.#.###.#.#.#.#.###.###.#########.#.###########.#####.#.#.#.###.#.###.#.#.#.#.###.#.#.#########.#
            #.#.#.>.#...#...#...#.#.....#.........#.#...#.#.#...#.#.#.#.###...#.#.........#.#...###...#...#...#.#.#.#...#...#.#.#.#.#...#.#.#.#...#.....#
            #.#.#v#########.#.#.#.#.#############.#.###.#.#.#.###.#.#.#.#####.#.#.#########.#.#.###.#.###.#.###.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.#.#####
            #...#...###.....#.#.#.#.#...#...#.....#.#...#...#.#...#...#...###.#.#.#.........#.#.#...#...#.#.###.#.#.#.#...#.#...#.#.#...#.#.#.#.#...#...#
            #######.###.#####.#.#.#.#.#.#.#.#.#####.#.#######.#.#########.###.#.#.#.#########.#.#.#####.#.#.###.#.#.#.#.#.#.#####.#.#.###.#.#.#.#####.#.#
            ###...#...#.....#.#.#.#.#.#.#.#.#...#...#.......#.#.....#.....#...#...#...#...#...#.#.#...#...#.#...#.#.#...#.#...#...#.#.#...#.#.#...###.#.#
            ###.#.###.#####.#.#.#.#.#.#.#.#.###.#.#########.#.#####.#.#####.#########.#.#.#.###.#.#.#.#####.#.###.#.#####.###.#.###.#.#.###.#.###.###.#.#
            #...#.....###...#.#.#.#.#.#...#.###.#.#...#...#.#.#...#.#.>.>...#.........#.#.#.#...#...#.....#...#...#.#.....###.#.###.#.#...#.#...#...#.#.#
            #.###########.###.#.#.#.#.#####.###.#.#.#.#.#.#.#.#.#.#.###v#####.#########.#.#.#.###########.#####.###.#.#######.#.###.#.###.#.###.###.#.#.#
            #.#...#.....#.###.#.#.#.#.#.....#...#...#.#.#.#.#.#.#...###.....#.......#...#...#.#...#...###.....#...#.#.#.>.>.#.#.#...#...#.#.#...#...#.#.#
            #.#.#.#.###.#.###.#.#.#.#.#.#####.#######.#.#.#.#.#.###########.#######.#.#######.#.#.#.#.#######.###.#.#.#.#v#.#.#.#.#####.#.#.#.###.###.#.#
            #...#.#.###.#...#.#.#.#.#.#.>.>...#.....#.#.#...#...#...........#.......#.......#...#.#.#...#.....###...#...#.#.#.#.#.###...#.#...#...#...#.#
            #####.#.###.###.#.#.#.#.#.###v#####.###.#.#.#########.###########.#############.#####.#.###.#.###############.#.#.#.#.###.###.#####.###.###.#
            #...#...#...###.#.#...#.#.#...#...#.#...#...#.......#...#...#####.....#...#...#.#.....#...#.#.........#.....#.#.#.#.#...#.....###...#...#...#
            #.#.#####.#####.#.#####.#.#.###.#.#.#.#######.#####.###.#.#.#########.#.#.#.#.#.#.#######.#.#########.#.###.#.#.#.#.###.#########.###.###.###
            #.#.......#...#...#...#...#...#.#.#.#.....#...#.....###...#...#.....#.#.#.#.#.#.#...>.>.#.#.....#.....#...#.#.#...#.....###...#...#...#...###
            #.#########.#.#####.#.#######.#.#.#.#####.#.###.#############.#.###.#.#.#.#.#.#.#####v#.#.#####.#.#######.#.#.#############.#.#.###.###.#####
            #...#.....#.#.......#.......#.#.#.#.###...#...#...#...#...#...#.#...#...#...#...#...#.#.#.....#.#...###...#.#.........#.....#...###.#...#...#
            ###.#.###.#.###############.#.#.#.#.###.#####.###.#.#.#.#.#.###.#.###############.#.#.#.#####.#.###.###.###.#########.#.###########.#.###.#.#
            #...#...#...#.......#.......#...#...#...#...#.#...#.#.#.#...#...#.......#.........#...#.#.....#.#...#...###...#.....#.#.............#.....#.#
            #.#####.#####.#####.#.###############.###.#.#.#.###.#.#.#####.#########.#.#############.#.#####.#.###.#######.#.###.#.#####################.#
            #...#...#.....#...#...#####...#.....#.....#...#.....#.#...#...#.........#.......###...#...#...#.#.###.....###.#...#.#.#.........#.......#...#
            ###.#.###.#####.#.#########.#.#.###.#################.###.#.###.###############.###.#.#####.#.#.#.#######.###.###.#.#.#.#######.#.#####.#.###
            #...#.#...#.....#.......###.#.#...#.###.....#...#.....###.#.#...#.....#.....###.#...#.......#.#.#.#.....#...#...#.#.#.#.......#.#.#...#...###
            #.###.#.###.###########.###.#.###.#.###v###.#.#.#.#######.#.#.###.###.#.###.###.#.###########.#.#.#.###.###.###.#.#.#.#######.#.#.#.#.#######
            #...#.#.....#...#...#...#...#...#.#...>.>.#...#...#...###...#.....#...#...#.#...#...#.........#.#.#...#...#...#.#.#...#.......#...#.#.......#
            ###.#.#######.#.#.#.#.###.#####.#.#####v#.#########.#.#############.#####.#.#.#####.#.#########.#.###.###.###.#.#.#####.###########.#######.#
            ###...#.......#...#...###.....#.#.#.....#.#...#.....#.....#.......#...#...#.#...#...#.#.......#...###...#.....#...#...#.............#.......#
            #######.#####################.#.#.#.#####.#.#.#.#########.#.#####.###.#.###.###v#.###.#.#####.#########.###########.#.###############.#######
            ###...#.......#...###...#...#.#...#...###...#.#.....#.....#.....#.....#...#.#.>.>.#...#.#.....###...#...#...#...###.#.###.............###...#
            ###.#.#######.#.#.###.#.#.#.#.#######.#######.#####.#.#########.#########.#.#.#v###.###.#.#######.#.#.###.#.#.#.###.#.###.###############.#.#
            #...#.#...###...#...#.#.#.#...#.......#.......#...#.#.#...#...#.....#.....#.#.#...#...#.#...#...#.#.#...#.#.#.#.#...#...#.......#...#...#.#.#
            #.###.#.#.#########.#.#.#.#####.#######.#######.#.#.#.#.#.#.#.#####v#.#####.#.###.###.#.###.#.#.#.#.###.#.#.#.#.#.#####.#######.#.#.#.#.#.#.#
            #...#...#...........#.#.#.....#.......#.#...#...#.#.#.#.#.#.#.#...>.>.#.....#.###...#...#...#.#.#.#.#...#.#.#.#.#.#.....#...#...#.#.#.#...#.#
            ###.#################.#.#####.#######.#.#.#.#.###.#.#.#.#.#.#.#.###v###.#####.#####.#####.###.#.#.#.#v###.#.#.#.#.#.#####.#.#v###.#.#.#####.#
            #...#...#.....#...#...#.#...#.#.......#.#.#.#.#...#.#...#...#...###.###.#.....#...#.....#.#...#.#.#.>.>...#.#.#.#.#.....#.#.>.###.#.#.#.....#
            #.###.#.#.###.#.#v#.###.#.#.#.#.#######.#.#.#.#.###.###############.###.#.#####.#.#####.#.#.###.#.###v#####.#.#.#.#####.#.###v###.#.#.#.#####
            #.....#...###...#.>.###...#...#.......#...#...#...#.....#.........#...#.#.#.....#.......#...#...#...#...###...#...#.....#.###...#.#.#.#.#...#
            #################v###################.###########.#####.#.#######.###.#.#.#.#################.#####.###.###########.#####.#####.#.#.#.#.#.#.#
            #...###...###...#.........#...........###...#.....#.....#.......#.#...#...#.....#.....#...###.....#.###.....###...#.....#...###.#.#...#...#.#
            #.#.###.#.###.#.#########.#.#############.#.#.#####.###########.#.#.###########.#.###.#.#.#######.#.#######.###.#.#####.###.###.#.#########.#
            #.#...#.#.#...#...........#.........#...#.#.#.#...#.....#.......#.#.....#.......#.#...#.#.....###...#.......#...#.....#.#...#...#.#.........#
            #.###.#.#.#.#######################.#.#.#.#.#.#.#.#####.#.#######.#####.#.#######.#.###.#####.#######.#######.#######.#.#.###.###.#.#########
            #...#...#...#...........###.........#.#.#.#.#...#...#...#.#.....#.#.....#.......#.#.....#.....#...###...#...#.#...#...#...###.....#.........#
            ###.#########.#########.###.#########.#.#.#.#######.#.###.#.###.#.#.###########.#.#######.#####.#.#####.#.#.#.#.#.#.#######################.#
            #...#...#.....#...#.....#...#...#.....#...#.......#.#.###...###.#...#...###...#...###...#.....#.#.#...#...#...#.#.#...#...#...#.....#.....#.#
            #.###.#.#.#####.#.#.#####.###.#.#.###############.#.#.#########.#####.#.###.#.#######.#.#####.#.#.#.#.#########.#.###.#.#.#.#.#.###.#.###.#.#
            #.....#...###...#.#.....#.....#...#...#...#.......#.#.#.........#...#.#.#...#.....#...#.#...#.#.#.#.#...#.......#.....#.#.#.#.#...#.#...#...#
            #############.###.#####.###########.#.#.#.#.#######.#.#.#########.#.#.#.#.#######.#.###.#.#.#.#.#.#.###.#.#############.#.#.#.###.#.###v#####
            #...#...###...###.#.....#...........#...#...#.....#...#...........#.#.#.#.#.......#...#...#...#.#...#...#...#...###.....#.#.#...#.#.#.>.#...#
            #.#.#.#.###.#####.#.#####.###################.###.#################.#.#.#.#.#########.#########.#####.#####.#.#.###.#####.#.###.#.#.#.#v#.#.#
            #.#.#.#.#...#...#...#...#.........#...###...#.#...###.............#.#.#.#.#.#...#...#.#...#...#.#.....#...#.#.#...#...###...###.#.#...#...#.#
            #.#.#.#.#v###.#.#####.#.#########.#.#.###.#.#.#.#####.###########.#.#.#.#.#.#.#.#.#.#v#.#.#.#.#.#.#####.#.#.#.###.###.#########.#.#########.#
            #.#.#.#.#.>.#.#.#.....#...#.......#.#.....#...#.#...#...........#...#.#...#.#.#.#.#.>.>.#...#.#.#.#...#.#.#...#...###.........#.#.#.........#
            #.#.#.#.#v#.#.#.#.#######.#.#######.###########.#.#.###########.#####.#####.#.#.#.###v#######.#.#.#.#.#.#.#####v#############.#.#.#.#########
            #.#...#...#...#.#...#.....#.....###.......#.....#.#...#...#...#.#...#.....#.#.#.#.#...#...###...#...#.#.#...#.>.>.#...#...#...#...#.........#
            #.#############.###.#.#########v#########.#.#####.###.#.#.#.#.#.#.#.#####.#.#.#.#.#.###.#.###########.#.###.#.#v#.#.#.#.#.#.###############.#
            #...#.........#...#.#.......#.>.>.###.....#...#...#...#.#.#.#...#.#.#...#.#...#...#...#.#.......###...#...#...#.#.#.#...#...#.....#.....#...#
            ###.#.#######.###.#.#######.#.#v#.###.#######.#.###.###.#.#.#####.#.#.#.#.###########.#.#######.###.#####.#####.#.#.#########.###.#.###.#.###
            ###...#...#...###.#.....#...#.#.#...#.....#...#.#...###.#.#.....#.#.#.#.#.......#.....#.#.....#...#.......#.....#.#.....#...#...#...###...###
            #######.#.#.#####.#####.#.###.#.###.#####.#.###.#.#####.#.#####v#.#.#.#.#######.#.#####.#.###.###.#########.#####.#####.#.#.###.#############
            #.......#.#...#...#.....#.....#...#.#...#.#...#.#...#...#.#...>.>.#...#...#.....#.......#...#.#...###.....#.....#.....#.#.#...#.........#####
            #.#######.###.#.###.#############.#.#.#.#.###.#.###.#.###.#.###v#########.#.###############.#.#.#####.###.#####.#####.#.#.###.#########.#####
            #.....###...#.#...#...#...........#...#.#.#...#.###.#.#...#.#...#####...#...###...###.......#...#...#...#.......#...#...#...#.#...#...#.....#
            #####.#####.#.###.###.#.###############.#.#.###.###.#.#.###.#.#######.#.#######.#.###.###########.#.###.#########.#.#######.#.#.#.#.#.#####.#
            #####.....#...#...#...#.#.............#...#...#...#.#.#...#.#...###...#.....#...#...#.....#.....#.#...#.#.......#.#.....#...#...#...#.......#
            #########.#####.###.###.#.###########.#######.###.#.#.###.#.###.###.#######.#.#####.#####.#.###.#.###.#.#.#####.#.#####.#.###################
            #.........#...#.....###...#...#.......#...#...#...#...###...###.#...#.......#.....#.#.....#.#...#...#...#.#.....#.#.....#...............#...#
            #.#########.#.#############.#.#.#######.#.#.###.###############.#.###.###########.#.#.#####.#.#####.#####.#.#####.#.###################.#.#.#
            #.........#.#...#...........#.#.......#.#.#.....#...###...#.....#...#.#...#...###.#.#.....#.#.....#.#...#.#.....#.#.....#.....#.......#.#.#.#
            #########.#.###.#.###########.#######.#.#.#######.#.###.#.#.#######.#.#.#.#.#.###.#.#####v#.#####.#.#.#.#.#####.#.#####.#.###.#.#####.#.#.#.#
            #.........#.#...#.......#...#.........#.#.#.....#.#...#.#.#.....#...#.#.#.#.#.#...#.#...>.>.#.....#...#...#.....#.#.....#...#.#.....#.#...#.#
            #.#########.#.#########.#.#.###########.#.#.###.#.###.#.#.#####.#.###.#.#.#.#.#.###.#.###v###.#############.#####.#.#######.#.#####v#.#####.#
            #.........#.#.#.....###...#.#...#.....#.#...#...#.#...#.#.#.....#.###...#...#.#...#...###.#...#...#.....#...###...#.#.....#.#...#.>.#.#.....#
            #########.#.#.#.###.#######.#.#.#.###.#.#####.###.#.###.#.#.#####.###########.###.#######.#.###.#.#.###.#.#####.###.#.###.#.###.#.#v#.#.#####
            #.........#.#.#.#...#...###...#...#...#.....#...#.#.#...#.#.....#.....###...#.#...#.......#...#.#.#...#.#...#...#...#.###.#.###.#.#.#...#...#
            #.#########.#.#.#.###.#.###########.#######.###.#.#.#.###.#####.#####.###.#.#.#.###.#########.#.#.###.#.###v#.###.###.###.#.###.#.#.#####.#.#
            #.....#.....#.#.#.#...#.#.....#.....###...#.#...#.#.#.#...#...#.#...#...#.#...#.###.#...#####.#.#.#...#.#.>.>.###...#...#.#...#...#...###.#.#
            #####.#.#####.#.#.#.###.#.###.#.#######.#.#.#.###.#.#.#.###.#.#v#.#.###.#.#####.###.#.#.#####.#.#.#.###.#.#v#######.###.#.###.#######.###.#.#
            #...#.#...#...#.#.#.#...#...#.#.#.....#.#.#.#.#...#.#.#.#...#.>.>.#...#.#.....#...#...#.....#...#.#.###...#.....#...#...#...#.#...###...#.#.#
            #.#.#.###.#.###.#.#.#.#####.#.#v#.###.#.#.#.#.#.###.#.#.#.#####v#####.#.#####.###.#########.#####.#.###########.#.###.#####.#.#.#.#####.#.#.#
            #.#...#...#...#.#.#.#...#...#.>.>.###...#...#.#.#...#.#.#.....#...###...#.....#...#.........#...#...#...........#...#...###...#.#.#...#...#.#
            #.#####.#####.#.#.#.###.#.#####v#############.#.#.###.#.#####.###.#######.#####.###.#########.#.#####.#############.###.#######.#.#.#.#####.#
            #.....#...#...#.#.#.###.#...###...........#...#.#.#...#.......###.......#.......###.........#.#.#...#...........###...#.#.......#...#.......#
            #####v###.#.###.#.#.###.###.#############.#.###.#.#.###################.###################.#.#.#.#.###########.#####.#.#.###################
            #...#.>.#.#.#...#...#...#...#.............#.....#...#...................#.......###...#...#...#...#.###...#.....#...#...#...#...............#
            #.#.#v#.#.#.#.#######.###.###.#######################.###################.#####.###.#.#.#.#########.###.#.#.#####.#.#######.#.#############.#
            #.#...#...#...###...#.....###...#.........#...#.....#...................#.....#.#...#...#.....#...#.#...#...#...#.#.#...###.#.#.......#.....#
            #.###############.#.###########.#.#######.#.#.#.###.###################.#####.#.#.###########.#.#.#.#.#######.#.#.#.#.#.###.#.#.#####.#.#####
            #.#.......#.....#.#.......#.....#.###.....#.#.#...#.#...###...###...#...#.....#.#...#...#...#...#...#.........#...#...#...#...#.....#...#####
            #.#.#####.#.###.#.#######.#.#####.###.#####.#.###.#.#.#.###.#.###.#.#.###.#####.###.#.#.#.#.#############################.#########.#########
            #.#.#.....#.#...#...#.....#.....#.#...#...#.#...#.#.#.#.#...#.#...#...###...#...###...#...#.......#.....###...#.....#...#...#.....#.........#
            #.#.#.#####.#.#####.#.#########.#.#.###.#.#.###.#.#.#.#.#.###.#.###########.#.###################.#.###.###.#.#.###.#.#.###.#.###.#########.#
            #.#.#.....#.#.#.....#...#.......#.#...#.#.#...#.#.#.#.#.#...#.#...###...#...#.#...#.........#...#.#...#.....#.#.###...#.....#...#...........#
            #.#.#####.#.#.#.#######.#.#######.###.#.#.###.#.#.#.#.#.###.#.###v###.#.#.###.#.#.#.#######.#.#.#.###.#######.#.###############.#############
            #...#...#.#.#.#.#.......#...#.....###...#.#...#...#.#.#...#.#...>.>.#.#.#.#...#.#.#.....###...#...###...#...#...#...#.....#...#.............#
            #####.#.#.#.#.#.#.#########.#.###########.#.#######.#.###.#.#####v#.#.#.#.#.###.#.#####.###############.#.#.#####.#.#.###.#.#.#############.#
            #.....#...#.#...#.........#...###...#.....#.......#.#.###...#.....#.#.#.#.#...#.#.....#.......#...#...#...#...#...#.#.#...#.#.#.....###.....#
            #.#########.#############.#######.#.#.###########.#.#.#######.#####.#.#.#.###.#.#####.#######.#.#.#.#.#######.#.###.#.#.###.#.#.###.###.#####
            #...#.....#.......#.......#.......#...#...#.....#.#.#.#.......#...#...#.#.###...#.....#.......#.#.#.#...#.....#...#...#.....#.#...#.....#...#
            ###.#.###.#######.#v#######.###########.#.#.###.#.#.#.#.#######.#.#####.#.#######.#####.#######.#.#.###.#.#######.###########.###.#######.#.#
            #...#.###...#.....#.>.#...#...........#.#...###.#.#.#.#...#.....#...#...#.......#...#...###...#.#.#.#...#...#...#.#...#.......###.........#.#
            #.###.#####.#.#####v#.#.#.###########.#.#######.#.#.#.###.#.#######.#.#########.###.#.#####.#.#.#.#.#.#####.#.#.#.#.#.#.###################.#
            #...#...#...#.###...#...#...#.........#.......#...#...#...#.#.......#...#.....#.#...#...###.#.#.#.#.#.#...#.#.#.#...#.#.#.....#.....#.....#.#
            ###.###.#.###.###.#########.#.###############.#########.###.#.#########.#.###.#.#.#####.###.#.#.#.#.#.#.#.#v#.#.#####.#.#.###.#.###.#.###.#.#
            #...#...#.....#...###.......#.........#.....#...#.....#.....#.........#.#...#.#.#.....#.#...#.#.#.#.#.#.#.>.>.#.#...#.#.#...#.#...#.#...#...#
            #.###.#########.#####.###############v#.###.###.#.###.###############.#.###.#.#.#####.#v#.###.#.#.#.#.#.###v###.#.#.#.#.###.#.###.#.###v#####
            #.#...#####.....#...#...#.....#...#.>.>.###.....#.#...#...............#.....#...#####.>.>.###.#.#.#.#.#.###...#.#.#.#.#...#.#.#...#.#.>.#...#
            #.#.#######.#####.#.###.#.###.#.#.#.#v###########.#.###.###############################v#####.#.#.#.#.#.#####.#.#.#.#.###.#.#.#.###.#.#v#.#.#
            #...#...#...#.....#.#...#.###.#.#.#.#.............#...#.....#...#.......#...#...###...#...###...#.#.#.#.#...#.#.#.#.#...#.#.#.#.###...#...#.#
            #####.#.#.###.#####.#.###.###.#.#.#.#################.#####.#.#.#.#####.#.#.#.#.###.#.###.#######.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###########.#
            #...#.#.#.....#.....#...#.###...#...#...#...#...#...#.#.....#.#...#.....#.#.#.#.....#...#.......#.#.#...#.#...#...#.....#.#.#.#.#...#.......#
            #.#.#.#.#######.#######.#.###########.#.#.#.#.#.#.#.#.#.#####.#####.#####.#.#.#########.#######.#.#.#####.###############.#.#.#.#.#.#.#######
            #.#...#.###...#.......#.#...#.........#...#...#...#...#.......#.....#...#.#.#.....#...#.........#...#...#...............#.#.#...#.#.#.......#
            #.#####.###.#.#######.#.###.#.#################################.#####.#.#.#.#####.#.#.###############.#.###############.#.#.#####.#.#######.#
            #.#...#...#.#.........#...#.#...#...........###.....#...#.....#.......#...#.....#...#...........#...#.#.................#...#.....#.........#
            #.#.#.###.#.#############.#.###.#.#########.###.###.#.#.#.###.#################.###############.#.#.#.#######################.###############
            #...#.#...#.............#...#...#.#.......#...#.#...#.#.#...#.#.......#...#...#.#...............#.#.#...#.......#.....###...#.....#.........#
            #####.#.###############.#####.###.#.#####.###.#.#.###.#.###.#.#.#####.#.#.#.#.#.#.###############.#.###.#.#####.#.###.###.#.#####.#.#######.#
            #.....#...#...#...#...#...###.....#.....#.#...#.#...#.#.....#...#...#...#...#...#...............#.#.###...###...#...#...#.#.#...#...#.......#
            #.#######.#.#.#.#.#.#.###.#############.#.#.###.###.#.###########.#.###########################.#.#.#########.#####.###.#.#.#.#.#####v#######
            #...#...#...#...#.#.#.....#...#.........#.#.###.#...#.............#.....###...#...#.............#.#.#...#.....#...#...#...#.#.#.#...>.#...###
            ###.#.#.#########.#.#######.#.#.#########.#.###.#.#####################.###.#.#.#.#.#############.#.#.#.#.#####.#.###.#####.#.#.#.###v#.#.###
            #...#.#.#.......#...#...#...#...#.....###...#...#...#...........###...#.#...#...#.#.....#.....###.#.#.#.#.....#.#.#...#.....#.#.#.#...#.#.###
            #.###.#.#.#####.#####.#.#.#######.###.#######.#####.#.#########.###.#.#.#.#######.#####.#.###.###.#.#.#.#####.#.#.#.###.#####.#.#.#.###.#.###
            #.#...#...#...#.......#.#.........###...#...#.#.....#.........#.....#...#.......#.......#.#...#...#.#.#.#...#.#.#.#...#.#...#.#.#.#.#...#...#
            #.#.#######.#.#########.###############.#.#.#.#.#############.#################.#########.#.###.###.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#####.#
            #.#.#.......#...........#.......#.......#.#...#.#...#...#...#.........###...###.......#...#.#...#...#.#.#.#.#.#.#.#...#...#.#.#...#.#.#.....#
            #.#.#.###################.#####.#.#######.#####.#.#.#.#.#.#.#########.###.#.#########.#.###.#.###.###.#.#.#.#v#.#.#.#######.#.#####.#.#.#####
            #...#.............#...#...#.....#.....###...#...#.#.#.#.#.#.#...###...#...#.#.....#...#.#...#...#.#...#.#.#.>.>.#.#.....#...#.....#.#.#.#...#
            #################.#.#.#.###.#########.#####.#.###.#.#.#.#.#.#.#.###v###.###.#.###.#.###.#.#####.#.#.###.#.#######.#####.#.#######.#.#.#.#.#.#
            #.................#.#.#.#...###...###.#...#.#.#...#.#.#.#.#.#.#.#.>.>.#.#...#...#.#...#.#.#...#.#.#...#.#.###...#...#...#...#.....#...#...#.#
            #.#################.#.#.#.#####.#.###v#.#.#.#.#.###.#.#.#.#.#.#.#.###.#.#.#####.#.###v#.#.#.#.#.#.###.#.#.###.#.###.#.#####.#.#############.#
            #...#.....#...#...#.#.#.#...#...#.#.>.>.#.#.#.#...#.#.#.#.#.#.#.#.###.#.#.#...#.#.#.>.>.#.#.#.#.#.#...#.#.....#.#...#.#.....#...#...........#
            ###.#.###.#.#.#.#.#.#.#.###.#.###.#.#####.#.#.###.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.#.#.#.###.#######.#.###.#.#######.#.###########
            ###...###...#...#...#...###...###...#####...#.....#...#...#...#...###...#...#...#...#####...#...#...###.........#.....#.........#...........#
            ###########################################################################################################################################.#
    """.trimIndent()
    )
    check(2034, result)
}

private fun test(input: String): Int {
    val map = input.split("\n")
    val width = map[0].length
    val height = map.size
    val cols = 0 until width
    val rows = 0 until height
    val startPoint = Point(1, 0)
    val endPoint = Point(width - 2, height - 1)
    fun value(p: Point) = map[p.y][p.x]

    fun Point.next(previous: Set<Point>): Set<Point> {
        val p = this
        return mutableSetOf<Point>().apply {
            if (value(p) == '>') {
                this += plus(1, 0)
            } else if (value(p) == 'v') {
                this += plus(0, 1)
            } else {
                this += plus(1, 0)
                this += plus(-1, 0)
                this += plus(0, 1)
                this += plus(0, -1)
            }
        }
            .filter { it.x in cols && it.y in rows }
            .filter { value(it) in setOf('.', '>', 'v') }
            .filter { it !in previous }
            .toSet()
    }

    fun dfs(currentPath: List<Point>, paths: MutableList<List<Point>>) {
        if (currentPath.last() == endPoint) {
            paths += currentPath.toList()

            println("path ${currentPath.size} steps long")
            for (y in rows) {
                for (x in cols) {
                    print(
                        if (Point(x, y) in currentPath) {
                            'O'
                        } else {
                            value(Point(x, y))
                        }
                    )
                }
                println()
            }
            println()
        } else {
            val next = currentPath.last().next(currentPath.toSet())
            for (nextPoint in next) {
                val newPath = mutableListOf<Point>()
                newPath += currentPath
                newPath += nextPoint
                dfs(newPath, paths)
            }
        }
    }

    val paths = mutableListOf<List<Point>>()
    val currentPath = mutableListOf<Point>()
    currentPath += startPoint
    dfs(currentPath, paths)
    return paths.map { it.size }.also { println(it) }.max()!! - 1
}
