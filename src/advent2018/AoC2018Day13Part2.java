package advent2018;

import utils.Point;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class AoC2018Day13Part2 {
    public static void main(String[] args) {
        String result;

        result = test("/>-<\\  \n" +
                "|   |  \n" +
                "| /<+-\\\n" +
                "| | | v\n" +
                "\\>+</ |\n" +
                "  |   ^\n" +
                "  \\<->/");
        assert result.equals("6,4") : "unexpected result is " + result;
        System.out.println(result);

        result = test("                                          /----------------------------------------------\\            /--------------------------\\                    \n" +
                "                     /--------------------+----------------------------------------------+------\\     |                 /--------+-------------\\      \n" +
                "                   /-+--------------------+----------------------\\                       |      | /---+-----------------+--------+----\\        |      \n" +
                "                   | |                    |                      |               /-------+------+-+---+-----------------+--------+----+-\\      |      \n" +
                "                   | |     /----------\\   |                      |/--------------+-------+------+-+---+-----------------+--------+\\   | |      |      \n" +
                "                   | |     |          |   |                      ||  /-----------+------\\|      | |   |                 |        ||   | |      |      \n" +
                "                   | |/----+----------+---+----------------------++--+-----------+------++--\\   | |   |  /-------------\\|        ||   | |      |      \n" +
                "                   | ||    |          |   |                      ||  |/----------+------++--+---+-+---+--+-------------++-\\      ||   | |      |      \n" +
                "                   | ||   /+----------+---+----------------------++--++-\\        |      ||  |   | |   |  |             || |      ||   | |      |      \n" +
                "                   | ||   ||          |   |         /------------++--++-+--------+------++--+---+\\|   |  |             || |      ||   | |      |      \n" +
                "                   | ||   ||          |   |         |            ||  || |        |      ||  |   |||   \\--+-------------++-+------/|   | |      |      \n" +
                "                   | ||   ||          |  /+---------+------------++--++-+--------+------++--+---+++------+-------------++-+--\\    |   | |      |      \n" +
                "                   | ||   ||         /+--++---------+------------++--++-+-----\\  |      ||  |   |||      |             || |  |    |   | |      |      \n" +
                "                   | ||   ||         ||  ||         |            ||  || |     |  |      ||  |   |||      |             || |  |    |   | |      |      \n" +
                "                  /+-++---++--\\  /---++--++-----\\   |            ||  || |     |  |      ||  |  /+++------+-----\\/------++-+--+----+---+-+------+--\\   \n" +
                "    /-------------++-++---++--+--+--\\||  ||     |   |            ||  || |     |  |      ||  |  ||||      \\-----++------/| |  |    |   | |      |  |   \n" +
                "    |             || ||/--++--+--+--+++--++-----+---+---\\        ||  || |     |  |      ||  |  ||||            ||       | |  |    |   | |      |  |   \n" +
                "    |             || |||  |\\--+--+--++/  ||     |   |   |/-------++--++-+----\\|  |   /--++--+--++++------------++-------+-+--+--\\ |   |/+------+--+\\  \n" +
                "    |             || |||  |   |  |  || /-++-----+---+\\  ||       ||  || |    ||  |   | /++--+--++++--\\         ||       | |  |  | |   |||      |  ||  \n" +
                "    |            /++-+++--+\\  |  |  || | ||     |   ||  ||       ||  || |    ||  \\---+-+++--+--++++--+---------++-------+-+--+--+-+---++/      |  ||  \n" +
                "    |     /------+++-+++--++--+--+--++-+-++-----+--\\||  ||  /----++--++-+----++------+-+++--+--++++--+---------++-------+-+--+--+-+---++------\\|  ||  \n" +
                "    |     |      ||| |||  ||  |  |  || | ||/----+--+++--++--+----++--++-+----++------+-+++--+--++++--+---------++-------+-+--+--+-+---++-\\    ||  ||  \n" +
                "    |     |      ||| |\\+--++--+--+--++-+-+++----+--+++--++--+----++--++-+----++------+-+++--/  ||||  |         ||       | |  |  | |   || |    ||  ||  \n" +
                "    |     |      ||| | |  ||  |  \\--++-+-+++----/  |||  ||  |    ||  || |    ||      | |||     ||||  |         ||       | |  |  | |   || |    ||  ||  \n" +
                "    |     |      ||| | |  ||/-+-----++-+-+++-------+++--++--+----++--++-+----++------+-+++-----++++--+---------++--->---+-+--+--+-+---++\\|    ||  ||  \n" +
                "    |     |      ||| | |  ||| |     || | \\++-------+++--++--+----++--++-+----++------+-+++-----++++--+---------++-------+-+--/  | |   ||||    ||  ||  \n" +
                "    |     |/-----+++-+-+--+++-+\\    || |  \\+-------+++--++--+----++--++-+----++------+-++/     ||||  |   /-----++------\\| |     | |   ||||    ||  ||  \n" +
                "    |     ||     |||/+-+--+++-++----++-+---+-------+++--++--+----++--++-+----++------+-++------++++--+---+-----++------++-+---\\ | |   ||||    ||  ||  \n" +
                "    |  /--++-----+++++-+-\\||| ||    || |   |       |\\+--++--+----++--++-+----++------+-++------++/^  |   |     ||      || |   | | |   ||||    ||  ||  \n" +
                "    |  |  ||     ||||| | |||| ||    || |   |       | |  ||  |    ||  || |    ||      | ||  /---++-+--+---+-----++------++-+---+-+-+---++++\\   ||  ||  \n" +
                "    |  |  ||     ||||| | |||| ||  /-++-+---+-------+-+--++--+----++--++-+----++------+-++--+---++-+--+---+-----++------++-+---+-+-+--\\|||||   ||  ||  \n" +
                "    |  |  ||     ||||| | |||| ||  | || |   |       | |  ||  |    ||  || |    ||      | ||  |   || |  |   |     ||      || |   | | |  ||||||   ||  ||  \n" +
                "    |  |  ||     ||||| |/++++-++--+-++-+---+\\      | |  ||  |  /-++--++-+----++------+-++--+---++-+--+---+-----++------++-+---+\\| |  ||\\+++---++--+/  \n" +
                "    |  |  ||     ||||| |||||| ||  | || |   ||      | |  || /+--+-++--++-+----++------+-++--+---++-+--+---+-----++-\\    || |   ||| |  || |||   ||  |   \n" +
                "    |  |  ||     ||||| |||||| ||  | || |   ||      | | /++-++--+-++--++-+----++------+-++--+---++-+--+-\\ |     || |    || |   ||| |  || |||   ||  |   \n" +
                "    |  |  ||     ||||| |||||| ||  | || |   ||     /+-+-+++-++--+-++--++-+---\\||      | ||  |   || |  | | \\-----++-+----/| |/--+++-+--++-+++\\  ||  |   \n" +
                "    |  |  ||     ||||| \\+++++-++--+-++-+---++-----++-+-+/| ||  | ||  || |   |||      | ||  |   || |  | |       || |     | ||  ||| |  || ||||  ||  |   \n" +
                "    |  |  ||     |||||  ||||| ||  | || |   ||     || | | | ||  | ||  || |  /+++------+-++--+-\\ || |  | |       ^| |     | ||  ||| |  || ||||  ||  |   \n" +
                "    |  | /++-----+++++--+++++-++--+-++-+---++-----++-+-+-+-++--+-++--++-+--++++------+-++--+-+-++-+--+-+\\      || |     | ||  ||| |  || ||||  ||  |   \n" +
                "    |  | |||     |||||  ||||| ||  | || |   ||     || | | | ||  |/++--++-+--++++------+-++--+-+-++-+--+-++------++-+-\\   | ||  ||| |  || ||||  ||  |   \n" +
                "   /+--+-+++-----+++++\\ ||||| ||  | || |/--++-----++-+-+-+-++--++++--++-+--++++------+-++--+-+-++-+--+-++-----\\|| | |   | ||  ||| |  || ||||  ||  |   \n" +
                "   ||  | |||     |||||| ||||| ||  | || ||  ||     || | | | ||  |||| /++-+--++++------+-++--+-+-++-+--+-++---\\ ||| | |   | ||  ||| |  || ||||  ||  |   \n" +
                "   ||  | |||     |||||| ||||| ||  | || ||  ||     ||/+-+-+-++--++++-+++-+--++++------+-++\\ | | \\+-+--+-++---+-+/| | |   | ||  ||| |  || ||||  ||  |   \n" +
                " /-++--+-+++-----++++++-+++++-++--+-++-++--++-----++++-+-+-++--++++-+++-+--++++------+-+++-+-+\\ | |  | ||   | | \\-+-+---+-++--+++-+--++-++++--++--/   \n" +
                " | ||  | |||     |||||| ||||| ||  | || ||  ||     |||| | | ||  |||| ||| |  ||||      | ||| | || | |  | ||   | |   | |   \\-++--+++-+--++-++++--+/      \n" +
                " | ||  | |||     |||||| ||||| ||  | || ||  ||     |||| | | ||  |||| ||| | /++++------+-+++-+-++-+-+--+-++---+-+--\\| |     ||  ||| |  || ||||  |       \n" +
                " | ||  | |||     |||||| ||||| ||  | || ||  \\+-----++++-+-+-++--++++-+++-+-+++++------+-+++-+-++-+-+--+-++---+-+--++-+-----++--+++-+--++-+/||  |       \n" +
                " | ||  | |||     |||||| ||||| ||  | || ||   |/----++++-+-+-++--++++-+++-+-+++++------+-+++-+-++-+-+--+-++---+-+--++-+-----++--+++-+--++-+\\||  |       \n" +
                " | ||  | |||     |||||| ||||| ||  | || ||   ||    |||| | | ||  |||| ||| | |||||      | ||| | || | \\--+-++---+-+--++-+-----++--+++-+--+/ ||||  |       \n" +
                " | ||  | |||/----++++++-+++++-++--+-++-++---++----++++-+-+-++--++++-+++-+-+++++------+-+++-+-++-+----+-++\\  | |  || |     ||  ||| |  |  ||||  |       \n" +
                " | ||  | ||||    \\+++++-+++/| ||  | || ||  /++----++++-+-+-++--++++-+++-+-+++++------+-+++-+-++-+----+-+++--+-+--++-+-----++--+++-+--+-\\||||  |       \n" +
                " | ||  | ||||     ||||| ||| | ||  | || ||  |||    |||| | | ||  |||| \\++-+-+++++------+-+++-+-++-+----+-+++--/ |  || |     ||  ||| |  | |||||  |       \n" +
                " | ||  | ||||     ||||| ||| | ||  | || ||  |||    |||| | | |\\--++++--++-+-+++++------+-+++-+-++-+----+-+++----+--++-+-----++--+++-+--+-+++++--/       \n" +
                " | ||  | ||||     ||||| ||| | ||  | || ||  |||    |||| | | |   ||||  || | |||||      | ||| | || |    | |||    |  || |     ||  ||| |  | |||||          \n" +
                " |/++--+-++++-----+++++-+++-+-++--+-++-++--+++----++++-+-+-+---++++--++-+-+++++------+-+++-+-++-+----+\\|||    |  || |     ||  ^v| |  | |||||          \n" +
                " ||||  | ||||     ||||| ||| | ||  | || ||  |||    |||| \\-+-+---++++--++-+-+++++------+-+++-+-++-+----++/||    |  || |     ||  ||| |  | |||||          \n" +
                " ||||  | ||||     ||||| ||| | ||  | |\\-++--+++----++++---+-+---++++--++-+-++++/      | ||| | || |    || ||    |  || |     ||  ||| |  | |||||          \n" +
                " ||||  | ||||     ||||| ||| | ||  | |  ||  |||/---++++---+-+---++++--++-+-++++--\\    | ||| | || |    || ||    |  || |     ||  ||| |  | |||||          \n" +
                " ||||  | ||||     ||||| ||| | ||  | |  \\+--++++---+++/   | |   ||||/-++-+-++++--+----+-+++-+-++-+\\   || ||    |  || |     ||  ||| |  | |||||          \n" +
                " ||||  | ||||     ||||| ||| | ||  | |   |  ||||   |||    | |   ||||| || | ||||  | /--+-+++-+-++-++---++-++----+--++-+-----++-\\||| |  | |||||          \n" +
                " ||||  | ||||     ||||| ||| | ||/-+-+---+--++++---+++----+-+---+++++-++-+-++++--+-+--+-+++-+-++-++--\\|| ||    |  || |     ||/++++-+--+-+++++------\\   \n" +
                " ||||  | ||||     ||||| ||| | ||| | |   |  ||||   |||    | |   |\\+++-++-+-++++--+-+--+-+++-+-++-++--+++-++----+--++-/ /---+++++++-+--+\\|||||      |   \n" +
                " ||||  | ||||     ||||| ||| | ||| | |   |  ||||   |||    | |   | ||| || | ||||  | |  | ||| | || ||  ||| ||    |  ||   |   ||||||| |  |||||||      |   \n" +
                " ||||  | ||||     |||||/+++-+-+++-+-+---+--++++---+++----+-+---+-+++-++-+-++++--+-+--+-+++-+-++-++--+++-++----+--++---+--\\||||||| |  |||||||      |   \n" +
                " ||||  | ||||     ||||||||| | ||| \\-+---+--++++---+++->--+-+->-+-+++-++-+-++++--+-+--+-+++-+-++-++--+++-++----+--++---+--++++++++-+--/||||||      |   \n" +
                " ||||  | ||||     ||||||||| | |||   |   |  ||\\+---+++----+-+---+-+++-++-+-++++--+-+--+-+++-+-++-++--+++-++----+--++---+--++++++++-+---+++/||      |   \n" +
                " ||||  | ||\\+-----+++++++++-+-+/|   |   |  || |   |||    | |   | ||| || | ||||  | |/-+-+++-+-++-++--+++-++----+--++\\  |  |||||||| |   ||| ||      |   \n" +
                " ||||/-+-++-+-----+++++++++\\| | |  /+---+--++-+---+++----+-+---+-+++\\|| | ||||  | || | |||/+-++-++--+++-++-\\  |  |||  |  |||||||| |   ||| ||      |   \n" +
                " ||||| | || |     |\\+++++++++-+-+--++---+--++-+---+++----+-+---+-/||||| | ||||  | || | ||||| || ||  ||| || |  |  |||  |  |||||||| |   ||| ||      |   \n" +
                " ||||| | || |     | ||||||||| | |  ||   |  || |   |||    | |   |  \\++++-+-++++--+-++-+-+++++-++-++--+++-++-+--+--+++--+--++++++++-/   ||| ||      |   \n" +
                " ||||| | |\\-+-----+-+++++++++-+-+--++---+--++-+---+/|    | |   |   |||| | ||||  | || | ||||| || ||  ||| || |  |  |||  \\--++++++++-----/|| ||      |   \n" +
                " ||||| | |  |     | ||||||||| | |  ||   |  || | /-+-+----+-+---+---++++-+-++++--+-++-+-+++++-++-++--+++-++-+--+\\ |||     ||||||||      || ||      |   \n" +
                " ||||| | |  |     | ||||||||| | |  ||   |  || | | | \\----+-+---+---++++-+-++++--+-++-+-++/|| || ||  ||| || |  || ||| /---++++++++------++-++\\     |   \n" +
                " ||||| | |  |     | ||||||||| | |  ||   |  || | | |      | |   |   |||| | ||||/-+-++-+-++-++-++-++--+++-++-+--++-+++-+---++++++++------++-+++-\\   |   \n" +
                " ||||| | |  |     | ||||||||| | |  ||   |  || |/+-+------+-+---+---++++-+-+++++\\| || | || || || ||  ||| || |  || ||| |   ||||||||      || ||| |   |   \n" +
                " ||||| | |  |     |/+++++++++-+-+--++---+--++-+++-+------+-+---+---++++-+-+++++++-++-+<++\\|| || ||  ||| || |  || ||| |   ||||||||      || ||| |   |   \n" +
                " |||\\+-+-+--+-----+++++++++++-+-+--+/   |  || ||| |      | |   |   |||| |/+++++++-++-+-+++++-++-++--+++-++-+--++-+++-+---++++++++-----\\|| ||| |   |   \n" +
                " ||| | | |  |   /-+++++++++++-+-+--+----+--++-+++-+------+-+---+---++++-+++++++++-++-+-+++++-++-++--+++-++-+\\ || ||| |   ||||^|||     ||| ||| |   |   \n" +
                " ||| | | |  |   | ||||||||||| | |  |    |  || ||| |      | |   |   |||| ||||||||| || | ||||| || || /+++-++-++-++-+++-+---++++++++---\\ ||| ||| |   |   \n" +
                " ||| | | |  |   | ||||||||||| | |  |    |  || ||| |   /--+-+---+---++++-+++++++++-++-+-+++++-++-++-++++-++-++-++\\||| |   ||||||||   | ||| ||| |   |   \n" +
                " ||| | | |  |   | ||||||||||| | |  |    |  || ||| |   |  | |   |   |||| ||||||||| || | |||\\+-++-++-++++-++-/| |||||| |   ||||||||   | ||| ||| |   |   \n" +
                " ||| | | |  |   | ||||||||||| | |  |    |  || ||| |   |  | \\---+---++++-+++++++++-++-+-+++-+-++-++-++++-++--+-++++/| |   ||||||||   | ||| ||| |   |   \n" +
                " ||| | | |  |   | ||||||||||| | |  |    |  \\+-+++-+---+--+-----+---++++-+++++++++-++-+-+++-+-++-++-++++-++--+-++++-+-+---++++++++---+-+/| ||| |   |   \n" +
                " ||| | | |  |   | ||||||||||| | |  |/---+---+-+++-+---+--+-----+---++++-+++++++++-++-+-+++-+-++-++-++++-++--+-++++-+-+--\\||||||||   | | | ||| |   |   \n" +
                " ||| | | |  |   |/+++++++++++-+-+--++---+---+-+++-+---+--+---\\ |   |||| ||||||||| || | ||| | || || |||| ||  | |||| | |  |||||||||   | | | v|| |   |   \n" +
                " ||| | | |  |   |||v||||||\\++-+-+--++---+---+-+++-+---+--+---+-+---++++-/|||||||| \\+-+-+++-+-++-++-++++-++--+-++++-+-+--+++++/|||   | | | ||| |   |   \n" +
                " ||| | | |  |   |||||||\\++-++-+-+--++---+---+-+++-+---+--+---+-+---++++--++++++++--+-+-+++-+-++-++-++++-++--+-++++-+-+--+/||| |||   | | | ||| |   |   \n" +
                "/+++-+-+-+--+---+++++++-++-++-+-+--++---+---+-+++-+---+-\\|   | |   ||||  ||||||||  | \\-+++-+-++-++-++++-++--+-++++-+-+--+-+++-++/   | | | ||| |   |   \n" +
                "|||| | | |  |   ||||||| || || | |  ||  /+---+-+++-+---+-++---+-+---++++--++++++++--+---+++-+-++-++-++++-++--+-++++-+-+--+-+++-++----+-+-+-+++\\|   |   \n" +
                "|||| | | |  |   ||||||| || || | |  ||  ||   | \\++-+---+-++---+-+---++++--+++++++/  |   ||| | || || |||| ||  | |||| | |  | ||| ||    | | | |||||   |   \n" +
                "|||| | | |  |/--+++++++-++-++-+-+--++--++---+--++-+---+-++---+-+---++++--+++++++---+---+++-+-++-++-++++-++--+-++++-+-+-\\| ||| ||    | | | |||||   |   \n" +
                "|||| | |/+--++--+++++++-++-++-+-+--++--++---+--++-+---+-++\\  | |   ||||  |||||||   |   ||| | || || |||| ||  | |||| | | || ||| ||    | | | |||||   |   \n" +
                "|||| | |||  ||  ||||||| || || | |/-++--++---+-\\|| |   | |||/-+-+---++++--+++++++---+---+++-+-++-++-++++-++--+-++++-+-+-++-+++-++---\\| | | |||||   |   \n" +
                "|||| | |||  ||  ||||||| || || | || |\\--++---+-+++-+---+-++++-+-+---++++--+++++++---+---+++-+-++-++-++++-++--+-++++-+-+-+/ ||| ||   || | | |||||   |   \n" +
                "|||| | |||  ||  ||||||| || || | || |   ||   | ||| |   | |||| | | /-++++--+++++++---+---+++-+-++-++-++++-++--+-++++-+-+-+\\ |\\+-++---++-+-+-+/|||   |   \n" +
                "|||| | |||  ||  ||||||| || |\\-+-++-+---++---+-+++-+---+-++++-+-+-+-++++--+++++++---+---+++-+-++-++-++++-++--+-++++-+-+-++-+-+-++---++-+-/ | |||   |   \n" +
                "|||| | |||  ||  ||||||| || |  | || |   ||   | ||| |   | |||| | | | ||||  |||||||   |   ||| | || || |||| ||  | |||| | | || | \\-++---++-+---+-+++---/   \n" +
                "|||| | |||  ||  ||||||| || | /+-++-+---++---+-+++-+\\  | |||| | | | ||||  |||||||   |   ||| | || || |||| ||  | |||| | | || |   ||   || |   | |||       \n" +
                "|||| | |||  ||  ||||||| || | || || |   || /-+-+++-++--+-++++-+-+-+-++++--+++++++---+---+++-+-++-++-++++-++--+-++++-+-+-++-+---++---++-+---+-+++-\\     \n" +
                "|||| | |||  ||  ||||||| || | || || |   || |/+-+++-++--+-++++\\| | | ||\\+--+++++++---+---+/| | || || |||| ||  | |||| | | || |   ||   || |   | ||| |     \n" +
                "|||| | |||  ||  ||||||| || | || || |   || ||| ||| ||  | |||||| | | || |  |||||||   |   | | | || || |||| ||  | |||| | | || |   ||   || |   | ||| |     \n" +
                "|||| ^ |||  ||  ||||||| || | || || |   || ||| ||| ||  | |||||| | | \\+-+--+++++++---+---+-+-+-++-+/ \\+++-++--+-++++-+-+-++-+---++---+/ |   | ||| |     \n" +
                "|||| | |||  ||  ||||||| || | || || |   || ||| ||| ||  | |||||| | |  | |  \\++++++---+---+-+-+-++-+---+++-++--+-++++-+-+-++-+---++---+--/   | ||| |     \n" +
                "|||| | |||  ||  ||||||| || | || || |   || ||| ||\\-++--+-++++++-+-+--+-+---++++++---+---+-+-+-++-+---+++-++--+-+/|| | | || |   ||   |      | ||| |     \n" +
                "|||| | |||  ||  |||||\\+-++-+-++-++-+---++-+++-++--++--+-++++++-+-+--+-+---++++++---+---+-+-+-++-/  /+++-++--+-+-++-+-+-++-+---++---+------+-+++-+--\\  \n" +
                "|||| | |||  ||  ||||| | || | || || |   || ||| ||  ||  | |||||| | |  | |   ||||||   |   | | | ||    |||| ||  | | || | | || |   ||   |      | ||| |  |  \n" +
                "|||| | ||v  ||  ||||| | || | || || |   || ||| ||  ||  | |||||| | |  | |   ||||||   |   | | | ||    |||| ||  | | || | | || |   ||   |      | ||| |  |  \n" +
                "|||| | |||  ||  ||||| | \\+-+-++-++-+---++-++/ ||  ||  | |||||| | |  | |   ||||||   |   | | | ||    |||| ||  | | || | | || |   ||   |      | ||| |  |  \n" +
                "|||| | ||| /++--+++++-+--+-+-++-++-+---++-++--++--++--+-++++++-+-+--+\\|   ||||||  /+---+-+-+-++----++++-++--+-+-++-+-+-++-+---++---+-\\    | ||| |  |  \n" +
                "|||| | ||| |||  ||||| |  | | || || |   || ||  ||  ||  | |||||| | |  |||   |||||v  ||   | | | ||    |||| ||/-+-+-++-+-+-++-+---++---+-+----+-+++-+--+-\\\n" +
                "|||| | ||| |||  ||\\++-+--+-+-+/ || |   |\\-++--++--++--+-++++++-+-+--+++---++++++--++---+-+-+-++----++++-+++-+-/ || | | || |   ||   | |    | ||| |  | |\n" +
                "|||| | ||| |||  || || |  | | |  || |   |  ||  ||  \\+--+-++++++-+-+--+++---++/|||  ||   \\-+-+-++----++/| ||| |   || | | || |   ||   | |    | ||| |  | |\n" +
                "|||| | ||| |||  || || |  | | |  || |   |  ||  ||   |  | |||||| | |  |||   || |||  ||     | | ||    || | ||| |   ||/+-+-++-+---++\\  | |    | ||| |  | |\n" +
                "||\\+-+-+++-+++--++-++-+--+-+-+--++-+---+--++--++---+--+-++++++-+-+--+++---++-+++--++-----+-+-++----++-/ ||| |   |||| | || |   |||  | |    | ||| |  | |\n" +
                "|| | | ||| |||  || || |  | | |  || |   |  ||  ||   |  | |\\++++-+-+--+++---++-/||  ||     | | ||    ||   ||| |   |||| | |v | /-+++--+-+--\\ | ||| |  | |\n" +
                "|| | | ||| |||  || || |  | | |  || |   |  ||  ||   |  | | |||| | |  ||\\---++--++--++-----+-+-++----++---+++-+---++++-+-++-/ | |||  | |  | | ||| |  | |\n" +
                "|| | | ||| v\\+--++-++-+--+-+-+--++-+---+--++--++---+--+-+-++++-+-+--++----++--++--++-----+-+-++----++---+/| |   |||| | ||   | |||  | |  | | ||| |  | |\n" +
                "|| | | \\++-+-+--++-++-+--/ | |  || |   \\--++--++---+--+-+-++++-+-+--++----++--++--++-----+-+-++----++---+-+-+---++++-+-++---+-+++--+-+--+-+-+/| |  | |\n" +
                "|| | |  || | |  || || |/---+-+--++-+------++--++---+--+-+-++++-+-+-\\||    ||  ||  ||     | | ||    ||   | | |   |||| | ||   | |||/-+-+--+-+-+-+-+-\\| |\n" +
                "|| | |  || | |  || || ||   | \\--++-+------++--++---/  | | |||| | \\-+++----++--++--++-----+-+-++----++---+-+-+---++++-+-+/   | |||| | |  | | | | | || |\n" +
                "|| | |  || | |  || |\\-++---+----++-+------++--++------+-+-++++-+---+++----++--++--++-----+-+-++----++---+-+-+---++++-+-+----+-/||| | |  | | | | | || |\n" +
                "|| | |  || | |  || \\--++---+----++-+------++--++------+-+-++++-+---+++----++--++--++-----/ | ||    ||   | | |   |||| | |    |  ||| | |  | | | | | || |\n" +
                "|| | |  || | |  ||    ||   |    \\+-+------++--++------+-+-++++-+---+++----++--++--++-------+-++----+/   | | |   |||| | |    |  ||| | |  | | | | | || |\n" +
                "|| | |  || | |  ||    ||   |     | |      ||  ||      | | |\\++-+---+++----++--++--++-------+-++----+----+-+-+---++++-+-+----+--+++-/ |  | | | | | || |\n" +
                "|| | |  || | \\--++----++---+-----+-+------++--++------+-+-+-++-+---+++----++--++--++-------+-++----+----+-+-+---++++-+-/    |  |||   |  | | | | | || |\n" +
                "|| | |  || |    ||    ||   |     | |      ||  ||      | | | || |   |||    ||  ||  ||       \\-++----+----+-+-+---++++-+------+--+++---+--+-/ | | | || |\n" +
                "|| | |  \\+-+----++----++---+-----+-+------++--++------+-+-/ || |  /+++----++--++--++---------++----+-\\  | | |   |||| |      |  |||   |  |   | | | || |\n" +
                "|| | |   | |    ||    ||   |     | |      ||  ||      | |   || |  ||||    ||  ||  ||         ||    | |  | | |   |||| \\------+--+++---+--+---/ | | || |\n" +
                "|| | |   | |    ||    |\\---+-----+-+------++--++------+-+---++-+--+/||    ||  \\+--++---------++----+-+--+-+-+---++++--------+--+++---+--+-----/ | || |\n" +
                "|| | |   | |    ||    |  /-+-----+-+------++--++------+-+---++-+--+-++---\\||   |  \\+---------++----+-+--+-+-+---++++--------+--+++---/  |       | || |\n" +
                "|| | |   | |    ||    |  | |     | |      ||  ||      | |   || |  | ||   |||   |   |         ||    | |  | | |   ||||        |  ||\\------+-------+-/| |\n" +
                "|| | |   | |    ||    |  | |     | |      \\+--++------+-+---++-+--+-++---+++---+---+---------++----+-+--+-+-+---++++--------+--++-------+-------/  | |\n" +
                "|| | |   | |    ||    |  | |     | |       |  ||      | |   || |  | ||   |||   |   \\---------++----+-+--+-+-+---+++/        |  ||       |          | |\n" +
                "|| | |   | \\----++----+--+-+-----+-+-------+--++------+-+---++-+--+-+/   |||   |             ||    \\-+--+-+-+---+++---------+--++-------+----------/ |\n" +
                "|| | |   |      ||    |  | |     | |       |  ||      | |   || |  |/+----+++-\\ |             ||      |  | | |   |||         |  ||       |            |\n" +
                "|| | |   |      ||    |  | |     | |       |  ||      | |   || |  \\++----+++-+-+-------------++------/  | | |   |||         |  ||       |            |\n" +
                "|| | |   |      ||    |  | |     | |       \\--++------+-+---/| \\---++----+++-+-+-------------++---------+-+-+---+++---------+--/|       |            |\n" +
                "|| | |   |      ||    |  | |     \\-+----------/|      | |    |     ||    ||\\-+-+-------------/|         | | |   |||         |   |       |            |\n" +
                "|| | \\---+------++----+--+-/       |           |      | |    |     ||    ||  | |              |         | \\-+---+++---------+---+-------+------------/\n" +
                "|| |     |      |\\----+--+---------+-----------+------+-+----/     ||    ||  | |              |         |   |   |||         \\---+-------/             \n" +
                "\\+-+-----+------+-----+--+---------+-----------+------+-/          ||    |\\--+-+--------------+---------+---+---+/|             |                     \n" +
                " | |     \\------+-----+--+---------+-----------+------+------------++----+---+-+--------------+---------/   |   | |             |                     \n" +
                " | |            |     |  |         |           \\------+------------++----+---+-/              |             |   | \\-------------/                     \n" +
                " | |            \\-----+--+---------+------------------+------------++----+---+----------------+-------------/   |                                     \n" +
                " | |                  |  \\---------+------------------+------------++----/   |                |                 |                                     \n" +
                " | \\------------------/            |                  |            ||        |                |                 |                                     \n" +
                " \\---------------------------------+------------------+------------++--------+------------->--/                 |                                     \n" +
                "                                   |                  |            \\+--------/                                  |                                     \n" +
                "                                   |                  \\-------------+-------------------------------------------/                                     \n" +
                "                                   \\--------------------------------/                                                                                 ");
        assert result.equals("16,134") : "unexpected result is " + result;
        System.out.println(result);

        result = test("/---------------------------------------------------------------------------------------------------\\                                                 \n" +
                "|                                                                          /------------------------+------------\\                                    \n" +
                "|  /-----------------------------------------------------------\\           |                        |  /---------+---------------------------------\\  \n" +
                "|  |                    /--------------------------------------+-----------+-------------\\          |  |         |                                 |  \n" +
                "|  |                    |     /--------------------------------+-----------+-------------+----------+--+---------+---------\\                       |  \n" +
                "|  |                    |   /-+--------------------------------+-----------+---------\\   |        /-+--+---------+---------+----------------\\      |  \n" +
                "|  |             /------+---+-+--------------------------------+-----------+---------+---+----\\   | |  |         |   /-----+----------------+-----\\|  \n" +
                "|  |             |      |   | |                    /-----------+-----------+---------+---+---\\|   | |  |         |   |     |                |     ||  \n" +
                "|/-+-------------+------+---+-+--------------------+-----------+-----------+---------+---+---++--\\| |  |         |   |     |                |     ||  \n" +
                "|| |             |      |   | |/-------------------+-----------+-----------+---------+---+---++--++-+--+---------+-\\ |     |                |     ||  \n" +
                "|| |      /------+--\\   |   | ||                   |           |           |         | /-+---++--++-+--+---------+-+-+-----+-------------\\  |     ||  \n" +
                "|| |      |      |  |   |   | ||                   |          /+-----------+---------+-+-+---++--++-+--+---------+-+-+-----+-------------+--+-----++-\\\n" +
                "|| |      |      |  |   |  /+-++------\\            |          ||           |         | | |   ||  || |  |  /------+-+-+-----+-----------\\ |  |     || |\n" +
                "|| |      |      |  |   |  || ||      |            |          ||           |    /----+-+-+---++--++-+--+\\ |      | | |     |           | |  |     || |\n" +
                "|| |      |      | /+---+--++-++------+-->---\\     |          ||           |    |    | | |   ||  || |  || |      | | |     |           | |  |     || |\n" +
                "|| |      |      | ||   |  || ||   /--+------+-----+--------\\ ||           |    |    | | |   ||  || |  || |      | | |     |           | |  |     || |\n" +
                "|| |      |      | ||   |  || ||   |  |      |     |        | |v           |    |    | | |   ||  || |  || |      | | v     |           | |  |     || |\n" +
                "|| \\------+------+-++---+--++-++---+--+------+-----+--------+-+/           |    |    | | |   ||  || |  || |      | | |     |           | |  |     || |\n" +
                "||        |      | ||   \\--++-++---+--+------+-----+--------+-+------------+----+----+-+-/   ||  || |  || |      | | |     |           | |  |     || |\n" +
                "||        |/-----+-++------++-++---+--+------+-----+--------+-+------------+----+----+-+-----++--++-+--++-+--\\   | | |     |           | |  |     || |\n" +
                "||        ||     | ||      || ||   |  |      |     |        | |            |    |    | |     ||  || |/-++-+--+---+-+-+-\\   |           | |  |     || |\n" +
                "|| /------++-----+-++-----\\|| ||   |  |      |     |        | |            | /--+----+-+-----++--++-++-++-+--+---+-+-+-+---+--\\        | |  |     || |\n" +
                "||/+------++-----+-++----\\||\\-++---+--+------+-----+--------+-+------------+-+--+----/ |     || /++-++-++-+--+---+-+-+-+---+--+--------+\\|  |     || |\n" +
                "||||      ||     | ||    |||  ||   |  |      |     |/-------+-+------------+\\|  |      |     || ||| || || |  | /-+-+-+-+---+--+--------+++--+-----++\\|\n" +
                "||||      ||     | ||    |||  ||   |  |      |     ||       |/+------------+++--+------+-----++-+++-++-++-+--+-+-+\\| | |   |  |        |||  |     ||||\n" +
                "||||     /++-----+-++--\\ |||  ||   |  |      |     ||       |||            ||| /+------+-----++-+++-++-++-+--+-+-+++-+-+---+--+--------+++-\\|     ||||\n" +
                "||||     |||     | ||  | |||  ||   |  |      |     ||       ||\\------------+++-++------+-----++-+++-++-++-+--+-+-+++-+-+---+--+--------+++-++-----+++/\n" +
                "||||     |||     | ||  | |||  ||   |  |      |     ||       ||  /----------+++-++------+-----++-+++-++-++-+--+-+-+++-+-+---+--+--------+++-++---\\ ||| \n" +
                "|||| /---+++-----+-++--+-+++--++---+--+------+-----++-------++--+------\\   ||| ||      |     || ||| || || |  | | ||| | |   |  |        ||| ||   | ||| \n" +
                "|||| |   |||     | ||  | |||  ||   |  |      |/----++-------++--+------+---+++-++------+-----++-+++-++-++-+--+-+-+++-+-+---+\\ |        ||| ||   | ||| \n" +
                "|||| |   |||     | ||  | |||  ||   |  |      ||    ||  /----++--+------+---+++-++\\     |  /--++-+++-++-++\\|  | | ||| | |   || |        ||| ||   | ||| \n" +
                "|||| |   |||     | ||  | |||  ||   |  |      ||    ||  |    ||  |      |   ||| |||     |  |  || ||| || ||||  | | ||| |/+---++-+--------+++\\||   | ||| \n" +
                "|||| |   |||     | ||  | |||  ||   |  |      ||    ||  |    || /+------+---+++-+++---\\ |  |  || ||| || ||||  | | ||| |||   || |        ||||||   | ||| \n" +
                "|||| |   |\\+-----+-+/  | |||  ||   |  |      ||    ||  |   /++-++------+-\\ ||| |||   | |  |  || ||| ||/++++--+-+-+++-+++---++-+------\\ ||||||   | ||| \n" +
                "|||| |   | |     | |   | |||  ||   |  |   /--++----++--+---+++-++------+-+-+++-+++---+-+--+--++-+++-+++++++--+-+-+++-+++---++-+\\     | ||||||   | ||| \n" +
                "|||| |   | |     | |   | |||  ||   |  |   |  ||    ||  |   ||| ||      | | ||| |||   | |  |  || ||| ||||||\\--+-+-+++-+++---++-++-----+-/|||||   | ||| \n" +
                "|||| |   | |     | |   | |||  ||   |  |   |  ||    ||  |   ||| ||      | | ||| |||   | |  |  || ||| ||||||   | | ||| |||   || ||     |  |||||   | ||| \n" +
                "|||| |   | |     | |   | |||  ||   | /+---+--++----++--+---+++-++------+-+-+++-+++---+-+--+--++-+++-++++++---+-+\\||| |||   || ||     |  |||||   | ||| \n" +
                "|||| |   | |  /--+-+---+-+++--++---+-++---+--++----++--+---+++-++------+-+-+++-+++---+-+\\ |  || ||| ||||||   | ||||| |||   || ||     |  |||||   | ||| \n" +
                "|||| |   | |  |  | |   | |||  || /-+-++---+--++----++--+---+++-++------+-+-+++-+++---+-++-+--++\\||| ||||||   | ||||| |||   || ||     |  |||||   | ||| \n" +
                "||\\+-+---+-+--+--+-+---+-/||  || | | || /-+--++----++--+---+++-++------+-+-+++-+++---+-++-+--++++++-++++++---+\\||||| |||   || ||     |  |||||   | ||| \n" +
                "|| | |   | |  |  | |   |  ||  || | | || | |  ||    ||  |   ||| ||      | | |||/+++---+-++-+--++++++-++++++---+++++++-+++---++-++-\\   |  |||||   | ||| \n" +
                "|| | |   | | /+--+-+---+--++--++-+-+-++-+-+--++\\   |\\--+---+++-++------+-+-+/|||||   | || |  |||||| ||||||   ||||||| |||   || || |   |  |||||   | ||| \n" +
                "|| | |   | | ||  | |   |  ||  || | | ||/+-+--+++---+---+---+++-++------+-+-+-+++++---+-++-+--++++++-++++++---+++++++-+++---++-++-+---+--+++++\\  | ||| \n" +
                "|| | |   | | ||  | |   |  ||  || | | |||| |  |||   |   |   ||| ||      | | | |||||   | || |  |||||| ||||||   ||||||| |||   || || |   |  ||||||  | ^|| \n" +
                "|| | |   | | ||  | |   |  ||  || | | |||| |  |||   |   |   ||| ||      | | | |||||   |/++-+--++++++-++++++---+++++++-+++--\\|| || |   |  ||||||  | ||| \n" +
                "|| | |   | | ||  | |   |  ||  || | | |||| |  |||   |   |   ||| ||      | | | |||||   |||| |  |||||| ||||||/--+++++++-+++--+++-++-+---+--++++++--+-+++\\\n" +
                "||/+-+---+-+-++--+-+--\\|  ||  || | | |||v |  |||   |   |   ||| ||  /---+-+-+-+++++---++++-+--++++++-+++++++--+++++++-+++--+++\\|| |   |  ||||||  | ||||\n" +
                "|||| |   | |/++--+-+--++--++--++-+-+-++++-+--+++---+---+---+++-++--+-->+-+-+-+++++---++++-+-\\|||||| ||\\++++--+++++++-+++--++++++-+---/  ||||||  | ||||\n" +
                "|||| |   | ||||  | |  ||  ||  || | | |||| |  |||   |   |   ||| ||  |   | | | |||||   |||| | ||||||| || \\+++--+++++++-+++--++++++-+------++++++--+-+/||\n" +
                "|||| |   | ||||  | |  ||  ||  || | | |||| |  |||   |   |   ||| ||  |   | | | |||||   |||| | ||||||| ||  |||  ||||||| |||  |||||| |      ||||||  | | ||\n" +
                "|||| |   | ||||  | |  ||  ||/-++-+-+-++++-+--+++---+---+---+++-++--+---+-+-+-+++++---++++-+-+++++++-++--+++--+++++++-+++--++++++-+-----\\||||||  | | ||\n" +
                "|||| |   | ||||  | |  ||  ||| || |/+-++++-+--+++---+---+---+++-++--+---+-+-+-+++++---++++-+-+++++++-++--+++--+++++++-+++--++++++-+----\\|||||||  | | ||\n" +
                "|||| |   | ||||/-+-+--++--+++-++-+++-++++-+--+++---+--\\|   ||| ||  |   | | | |||||   |||| | ||||||\\-++--+++--+++++++-+++--++++++-+----++++++/|  | | ||\n" +
                "|||| |   | ||||| | |  ||  ||| || ||| |||| |  |||   | /++---+++-++--+---+-+-+-+++++---++++-+-++++++--++--+++\\ ||||||| |||  |||||| |    |||||| v  | | ||\n" +
                "|||| |   | ||||| | |  ||  ||| ||/+++-++++-+--+++---+-+++---+++-++--+---+-+-+-+++++\\  |||| | ||||||  ||  |||| ||||||| |||  |||||| |    |||||| |  | | ||\n" +
                "|||| |   | ||||| | |  ||  ||| |||||| |||| |  |||   |/+++---+++-++--+---+-+-+-++++++--++++-+-++++++--++--++++-+++++++-+++--++++++-+----++++++-+-\\| | ||\n" +
                "|||| |   | ||||| | |  ||  ||| \\+++++-++++-+--+++---+++++---+++-++--+---+-+-+-++++++--++++-+-++++++--++--++++-+++++++-+++--+/|||| |    |||||| | || | ||\n" +
                "||\\+-+---+-+++++-+-+--/|  |||  ||||| |||| |  |||   |||||   ||| ||  |   | | | ||||||  |||| | ||||||  ||  ||\\+-+++++++-+++--+-++++-+----++++++-+-++-+-+/\n" +
                "|| | |   | ||||| \\-+---+--+++--+++++-++++-+--+++---+++++---+++-++--+---+-+-+-++++++--++++-+-++/|||  ||  || | ||||||| |||  | |||| |    |||||| | || | | \n" +
                "|| | |   | |\\+++---+---+--+++--+++++-++++-+--+++---+++++---+++-++--+---+-+-+-++++++--++++-+-/| |||  ||  || | ||||||| |||  | |||| |    |||||| | || | | \n" +
                "|| | | /-+-+-+++---+---+--+++--+++++-++++-+--+++---+++++---+++-++--+---+-+-+-++++++--++++\\|  | |||  ||  || | ||||||| |||  | |||| |    |||||| | || | | \n" +
                "|| | | | | | |||   |   |  |||  ||||| |||| |  |||   |||||   |||/++--+---+-+-+-++++++-\\||||||  | |||/-++--++-+-+++++++-+++--+-++++-+\\   |||||| | || | | \n" +
                "|| | | | | | |||   |   |  |||  ||||| |||| |  |||   |||||   ||||||  |   | | |/++++++-+++++++--+-++++-++--++-+-+++++++-+++--+-++++-++---++++++\\| || | | \n" +
                "|| | | | | | |||   |   |  |||  ||||| |||| |  |||   |||||   ||||||  |   | | |||||||| |||||||  | |||| ||  || | ||||||| |||  | |||| ||   |||||||| || | | \n" +
                "|| | | | | | |||   |   |  |||  ||||| |||| |  |||   |||||   ||||||  \\---+-+-++++++++-+++++++--+-++++-++--++-+-+++++++-+++--+-+/|| ||   |||||||| || | | \n" +
                "|| | | | | | |||   |   |  |||  ||||| |||| |  |||   |||||   ||||||      | | |||||||| |||||||  | |||| ||  || | ||||||| \\++--+-+-++-++---++++++++-++-/ | \n" +
                "|| | | | | | |||   |   |  |||/-+++++-++++\\|  |||   |||||   ||||||      | | \\+++++++-+++++++--+-++++-++--++-+-++++/||  ||  | | || ||   |||||||| ||   | \n" +
                "|| | | | | | |||   |   |  |||| ||||| ||||||  |||   |||||   ||\\+++------+-+--+++++++-+++++++--+-++++-++--++-+-++++-/|  ||  | | || ||   |||||||| ||   | \n" +
                "|| |/+-+-+-+-+++---+---+--++++-+++++-++++++--+++---+++++---++-+++------+-+--+++++++-+++++++--+-++++\\||  || | ||||  |  ||  | | || ^|   |||||||| ||   | \n" +
                "||/+++-+-+-+-+++---+---+\\ |||| ||\\++-++++++--+++---+++++---++-+++------+-+--+++++++-+++++++--+-/||||||  || | ||||  |  ||  | | || ||   |||||||| ||   | \n" +
                "\\+++++-+-+-+-+++---+---++-++++-++-++-++++++--+++---+++++---++-+++------+-+--+++++++-+++++++--+--++++/|  || | ||||  |  ||  | | || ||   |||||||| ||   | \n" +
                " ||||| | | \\-+++---+---++-++++-++-++-++++++--+++---+++++---++-+++------+-+--+++++++-+++++++--+--++++-+--++-+-/|||  |  ||  | | || ||   |||||||| ||   | \n" +
                " ||||| | |   |||   |   || |||| || || ||||||  |||   |||||   || |||      | |  ||||\\++-+++++++--+--++++-+--/| |  |||  |  ||  | | || ||   |||||||| ||   | \n" +
                " |||||/+-+---+++---+---++-++++-++-++-++++++--+++--\\|||||   || |||      | |  |||| || |||||||  |  |||| |   | |  |||  |  ||  | | || ||   |||||||| ||   | \n" +
                " ||||||| |   |||   |   || |||| || \\+-++++++--+++--++++++---++-+++------+-+--++++-++-+++++++--+--++++-+---+-+--+++--+--++--+-+-++-++---/||||||| ||   | \n" +
                " ||||||| |   |||   |   || |||| ||  | ||||||  |||  ||||||   || |||/-----+-+--++++-++-+++++++--+--++++-+---+-+--+++--+--++--+-+-++\\||    ||||||| ||   | \n" +
                " ||||||| |   |||   |   || |||| ||  | ||||||  |||  |||\\++---++-++++-----+-+--++++-++-+++++++--+--++++-+---+-/  |||  |  ||  | | |||||    ||||||| ||   | \n" +
                " ||||||| |   |||   |   || |||| \\+--+-++++++--+++--+++-++---++-++++-----+-+--++++-++-+++++++--+--++++-+---+----+++--/  ||  | | |||||    ||||||| ||   | \n" +
                " ||||||| |   |||   v   || ||||  |  | ||||||  |\\+->+++-++---++-++++-----+-+--++++-++-+++++++>-+--++++-+---+----+++-----++--+-/ |||||    ||||||| ||   | \n" +
                " ||||||| |   |||   \\---++-++++--+--+-++++++--/ |  ||| ||   || ||||     | |  |||| || |||||||  |  |||| |   |    |||     ||  |   |||||    ||||||| ||   | \n" +
                " ||||||| |  /+++-------++-++++--+--+-++++++----+--+++-++---++-++++-----+-+--++++-++-+++++++--+--++++-+---+--\\ |||     ||  |   |||||    ||||||| ||   | \n" +
                " ||||||| |/-++++-------++-++++--+--+-++++++----+--+++-++\\  || ||||   /-+-+--++++-++-+++++++--+--++++-+\\  |  | |||     ||  |   |||||    ||||||| ||   | \n" +
                " |\\+++++-++-++++-------+/ ||||  |  | ||||||    |  ||| |||  || ||\\+---+-+-+--++++-++-+++++++--+--++++-++--+--+-+++-----++--+---+++++----+++++++-+/   | \n" +
                " | ||||| || ||||       |  ||||  |  | ||||||    |  ||| |||  || || |   | | |  |||| || ||||||\\--+--++++-++--/  | |||     ||  |   |||||    ||||||| |    | \n" +
                " | ||||| || ||||    /--+--++++--+--+-++++++----+--+++-+++--++\\|| |   | | |  |||| || ||||||   |  |||| ||     | |||     ||  |   |||||    ||||||| |    | \n" +
                " |/+++++-++\\||||    |  v  ||||  |  |/++++++----+--+++-+++--+++++-+---+-+-+--++++-++-++++++---+--++++-++-----+-+++-----++-\\|   |||||    ||||||| |    | \n" +
                " ||||||| |||||||    |  |  ||||  |  ||||||||   /+--+++-+++--+++++\\|   | | |  |||| || ||||||   |  |||| \\+-----+-+++-----+/ ||   |||||    ||||||| |    | \n" +
                " ||||||| |||||||    |  |  ||||  |  ||||||||   ||  ||| |||  ||||\\++---+-+-+--++++-++-+/||||  /+--++++--+-----+-+++-----+--++\\  |||||    ||||||| |    | \n" +
                " ||||||| |||||||    |  |  ||||  |  ||||||||   ||  ||| |||  |||| ||   | | |  |||| || | ||||  ||  ||||  | /---+-+++---\\ |  |||  |||||    ||||||| |    | \n" +
                " ||||||| |||||||    |/-+--++++--+\\ ||||||||   ||  ||| |||  |||| ||   | | |  |||| || | ||||  ||  ||||  | | /-+-+++---+-+--+++--+++++----+++++++\\|    | \n" +
                " ||||||| |||||||    || |  ||||  || ||||||||/--++--+++-+++--++++-++---+-+-+--++++-++-+-++++--++--++++--+-+-+-+-+++---+-+--+++--+++++----+++++++++-\\  | \n" +
                " ||||||| |||||||  /-++-+--++++--++-+++++++++--++--+++-+++--++++-++---+-+-+--++++-++-+-++++--++--++++--+-+-+-+-+++---+-+--+++\\ |||||    ||||||||| |  | \n" +
                " ||||||| |||||||  | || |  ||||  || |||||||||  ||  ||| |\\+--++++-++---+-+-+--++++-/| | ||||  ||  ||||  | | | | |||   | \\--++++-+++++----+++/||||| |  | \n" +
                " ||||||| |||||||  | || |  ||||  || |||||||||  ||  ||| | |  |||| ||  /+-+-+--++++-\\| | ||||  ||  \\+++--+-+-+-+-+++---+----++++-+++++----+/| ||||| |  | \n" +
                " ||||||| |||||||  | || |  ||||  || |||||||||  ||  |\\+-+-+--++++-++--++-+-+--++++-++-+-++++--+/   |||  | | | | |||   |    |||| |||||    | | ||||| |  | \n" +
                " ||||||| ||||||| /+-++-+--++++--++-+++++++++--++--+-+-+-+--++++-++--++-+-+-\\\\+++-++-+-++++--+----+++--+-+-+-+-+++---+----++++-+++++----+-+-+/||| |  | \n" +
                " ||||||| ||||||| || || |  ||||  || |||||||||  ||  | | | |  |||\\-++--++-+-+-+-+++-++-/ |\\++--+----+++--+-+-+-+-+++---+----++++-+++++----+-/ | ||| |  | \n" +
                " ||||||| ||||||| || || |  ||||  || |||||||||  ||/-+-+-+-+--+++--++--++-+\\| | ||| ||   | ||  |    |||  | | | | |||   |    |||| |||||    |   | ||| |  | \n" +
                " ||||||| ||||||| || || |  |\\++--++-+++/|||||  ||| | | | |  |||  ||  || ||| | ||| ||   | ||  | /--+++--+-+-+-+-+++---+---\\|||| |||||    |   | ||| |  | \n" +
                " ||||||| |||||||/++-++-+--+-++--++-+++-+++++--+++-+-+-+-+--+++--++--++-+++-+-+++-++---+-++-\\| |  |||  | | | | |||   |/--+++++-+++++----+---+-+++-+-\\| \n" +
                " \\++++++-++++++++++-++-+--+-++--++-+++-+++++--+++-+-+-+-+--+++--++--++-+++-+-+++-++---+-++-++-+--/||  | | | | |||   ||  ||||| |||||    |   | ||| | || \n" +
                "  |||||| |||||||||\\-++-+--+-++--++-+++-+++++--+++-+-+-+-+--+++--++--++-+++-+-+++-++---+-++-++-+---++--+-+-+-+-+++---++--++++/ |||||    |   | ||| | || \n" +
                "  |||||| |||||||||  || |  | v|  || ||| |||||  ||| | | | |  |||  ||  || ||| | ||| ||   | || || |   ||  | | | | |||   ||  ||||  |||||    |   | ||| | || \n" +
                "  |||||| |||||||||  |\\-+--+-++--+/ ||| |||||  ||| | | | |  |||  ||  \\+-+++-+-+++-/|   | || || |   ||  | | | | |||   ||  ||||  |||||    |   | ||| | || \n" +
                "  |||||| ||||||||| /+--+--+-++--+\\ ||| |||||  ||| | | | |  |||  ||   | ||| | |||  |   | || || |   ||  | |/+-+-+++---++-\\||||  |||||    |   | ||| | || \n" +
                "  |||||| ||||||||| ||  |  | ||  || ||| |||||  \\++-+-+-+-+--+++--/|   | ||| | \\++--+---+-++-++-+---++--+-+++-+-+++---++-+++++--/||||    |   | ||| | || \n" +
                "  |||||| ||||||||| ||  |  | ||  || ||| |||||   || | | | |  |||   |   \\-+++-+--++--+---+-++-++-+---++--/ ||| | |||   || |||||   ||||    |   | ||| | || \n" +
                "  |||||| ||||\\++++-++--+--+-++--++-+++-+++++---/| | | | |  |||   |/----+++-+--++--+\\  | || || |   ||    ||| | |||   || |||||   ||||    |   | ||| | || \n" +
                "  |\\++++-++++-++++-++--+--/ ||/-++-+++-+++++----+-+-+-+-+--+++---++----+++-+--++--++--+-++-++-+---++----+++-+-+++---++-+++++---++++----+--\\| ||| | || \n" +
                "  | |||| |||| |||| ||  |    ||| || ||| |\\+++----+-+-+-+-+--+++---++----+++-+--++--++--+-++-++-+---++----+++-+-/||   || |||||   ||||    |  || ||| | || \n" +
                "  | |||| |||| ||\\+-++--+----+++-++-+++-+-+++----+-+-+-+-+--+++---++----+++-+--++--++--+-++-/| |   ||    ||| |  \\+---++-+++++---++++----+--++-+++-+-+/ \n" +
                "  | ||\\+-++++-++-+-++--+----+++-++-+++-+-+++----+-/ | | |  |||   ||    ||| |  ||  ||  | ||  | |   \\+----+++-+---+---++-+++++---+++/    |  || ||| | |  \n" +
                "  | || | |||| |\\-+-++--+----+++-++-+++-+-+++----+---+-/ |  |||/--++----+++-+--++--++--+-++--+-+----+----+++-+---+---++-+++++---+++-----+--++-+++-+-+-\\\n" +
                "  | || | |||| |  | ||  |    ||| || \\++-+-+++----+---+---+--+/||  ||    ||| |  ||  ||  | ||  | |    |    ||| |   |   || |||||   |||     |  || ||| | | |\n" +
                "  | || | |||| |  | ||  |    ||| ||  || | |||    |   |   |  | ||  ||    ||| |  \\+--++--+-++--+-+----+----+++-+--<+---++-+++++---++/     |  || ||| | | |\n" +
                "  | || | |||| |  | ||  |    ||| ||  || | ||\\----+---+---+--+-++--++----+++-+---+--++--+-++--+-+----+----+++-+---+---++-+++++---++------+--++-+++-/ | |\n" +
                "  | || | |||| |  | ||  |    ||| ||  || | ||     |   |   |  | ||  ||    ||| |   |  ||  | ||  | \\----+----+++-+---+---++-+/|||   ||      |  || |||   | |\n" +
                "  | || \\-++++-+--+-++--+----+++-++--++-+-++-----+---+---+--+-++--++----+++-+---+--++--+-+/  |      |    ||| |   |   || | |||   ||      |  || |||   | |\n" +
                "  | ||   |||| |  | ||  |    ||| ||  || | ||     |   |   |  | ||  ||    ||| |   |  ||  | |   |      |    ||| |   |   || | |||   ||      |  || |||   | |\n" +
                "  | ||/--++++-+--+\\||  |    ||| ||  \\+-+-++-----+---+---+--+-++--++----+++-+---+--++--+-+---+------+----+++-+---+---++-+-/||   ||/-----+--++-+++--\\| |\n" +
                "  | |||  |||| |  ||||  |    |\\+-++---+-+-/|     |   |   |  \\-++--++----++/ |   |  ||  | |   |      |    ||| |   |   || |  ||   |||     |  || |||  || |\n" +
                "  | |||  |||| |  ||||  |    | | ||   | |  |     |   \\---+----++--++----++--+---+--++--+-+---+------+----+++-+---+---++-+--++---+++-----+--++-++/  || |\n" +
                "  | |||  |||| | /++++--+----+-+-++-\\ | |  |     |       |    ||  ||    ||  |   \\--++--+-+---+------+----+++-+---+---++-+--++---+++-----+--+/ ||   || |\n" +
                "  | |||  |||| \\-+++++--+----+-+-++-+-+-+--+-----+-------+----++--++----++--+------++--+-/   |      |    ||| |   |   || |  || /-+++-----+--+--++---++\\|\n" +
                "  | |||  ||||   |||||  |    | | || | \\-+--+-----+-------+----++--++----++--+------++--+-----+------+----+++-+---/   || |  || | |||     |  |  ||   ||||\n" +
                "  | ||^  |||\\---+++++--+----+-+-++-+---+--+-----+-------+----++--++----++--+------++--+-----+------+----+++-/       || |  || | |||     |  |  ||   ||||\n" +
                "  | |||  |||    |||||  |   /+-+-++-+---+--+-----+-------+----++--++----++--+------++--+-----+------+--\\ |||         || |  || | |||     |  |  ||   ||||\n" +
                "  | |||  \\++----+++++--/   || | || |   |  |     \\-------+----++--++----+/  |      ||  |     |      |  | |\\+---------++-/  || | |||     |  |  ||   ||||\n" +
                "  | |||   ||    |\\+++------++-+-++-+---+--+-------------+----++--++----+---/      ||  |     |     /+--+-+-+---------++----++-+-+++-----+--+--++\\  ||||\n" +
                "  | |||   ||    | |||      || | || |   \\--+-------------+----++--++----+----------++--+-----+-----++--+-+-+---------++----++-+-+++-----+--+--/||  ||||\n" +
                "  | |||   \\+----+-+++------++-+-++-+------+-------------/    ||  ||    |          ||  |     |     ||  | | |         ||    || | ||| /---+--+---++-\\||||\n" +
                "  | |\\+----+----+-+++------++-+-++-+------+------------------++--++----/          ||  |     |     ||  | | |         ||    || | ||| |   |  |   || |||||\n" +
                "  | | |    |    | |||      || | || |      |                  ||  ||               ||  |     |     ||  | | \\----<----++----++-+-+++-+---+--+---/| |||||\n" +
                "  | | |    |    | |||      || | || |      |                  ||  \\+---------------++--+-----+-----++--+-+-----------++----++-+-+/| |   |  |    | |||||\n" +
                "  | | \\----+----+-/\\+------++-+-+/ |      \\------------------++---+---------------++--+-----+-----++--+-+-----------++----++-+-/ | |   |  |    | |||||\n" +
                "  | |      |   /+---+------++-+-+--+-------------------------++---+---------------++--+---\\ \\-----++--+-+-----------++----+/ |   \\-+---+--+----+-+/|||\n" +
                "  | |      |   ||   |      || | |  |                         ||   |               ||  |   |       ||  | |           ||    |  |     |   |  |    | | |||\n" +
                "  | |      |   ||   \\------++-+-+--+-------------------------/|   |               ||  |   |       \\+--+-+-----------++----+--+-----+---+--+----/ | |||\n" +
                "  | |      |   ||          \\+-+-+--+--------------------------+---+---------------++--+---+--------+--/ |           ||    |  |     |   |  |      | |||\n" +
                "  \\-+------/   ||           | | |  |                          |   |               ||  |   |        |    |           ||    |  |     \\---+--+------/ |||\n" +
                "    |          ||           | | \\--+--------------------------+---+---------------/|  |   |        |    |           ||    |  |         |  |        |||\n" +
                "    \\----------++-----------+-+----+--------------------------+---+----------------+--+---+--------/    |           ||    |  |         |  |        |||\n" +
                "               ||           | |    |                          \\---+----------------+--+---+-------------+-----------++----+--+---------+--+--------++/\n" +
                "               ||           | \\----+------------------------------+----------------+--+---+-------------+-----------++----+--+---------+--/        || \n" +
                "               ||           |      |                              |                |  \\---+-------------+-----------++----/  |         |           || \n" +
                "               ||           |      |                              |                |      |             |           ||       |         |           || \n" +
                "               ||           \\------+------------------------------+----------------+------+-------------+-----------++-------+---------/           || \n" +
                "               |\\---------<--------/                              \\----------------/      |             |           |\\-------+---------------------/| \n" +
                "               \\--------------------------------------------------------------------------/             \\-----------/        \\----------------------/ \n");
        assert result.equals("71,76") : "unexpected result is " + result;
        System.out.println(result);
    }

    public static String test(String s) {
        Map<Point, Character> points = new HashMap<>();
        List<Cart> carts = new ArrayList<>();
        String[] tokens = s.split("\n");
        for (int y = 0; y < tokens.length; ++y) {
            String token = tokens[y];
            char[] chars = token.toCharArray();
            for (int x = 0; x < chars.length; ++x) {
                Point key = new Point(x, y);
                char ch = chars[x];
                switch (ch) {
                    case '>':
                        points.put(key, '-');
                        carts.add(new Cart(key, Direction.right));
                        break;
                    case '<':
                        points.put(key, '-');
                        carts.add(new Cart(key, Direction.left));
                        break;
                    case 'v':
                        points.put(key, '|');
                        carts.add(new Cart(key, Direction.down));
                        break;
                    case '^':
                        points.put(key, '|');
                        carts.add(new Cart(key, Direction.up));
                        break;
                    default:
                        if (ch == '+' || ch == '-' || ch == '|' || ch == '\\' || ch == '/') {
                            points.put(key, ch);
                        }
                        break;
                }
            }
        }
        for (int step = 0; ; ++step) {
            int minX = Integer.MAX_VALUE, minY = Integer.MAX_VALUE, maxX = 0, maxY = 0;
            for (Cart cart : carts) {
                minX = Math.min(minX, cart.point.x);
                minY = Math.min(minY, cart.point.y);
                maxX = Math.max(maxX, cart.point.x);
                maxY = Math.max(maxY, cart.point.y);
            }
            List<Cart> orderedCarts = new ArrayList<>();
            for (int y = minY; y <= maxY; ++y) {
                for (int x = minX; x <= maxX; ++x) {
                    for (Cart cart : carts) {
                        if (cart.point.x == x && cart.point.y == y) {
                            assert !orderedCarts.contains(cart) : "already in list";
                            orderedCarts.add(cart);
                        }
                    }
                }
            }
            for (int i = 0; i < orderedCarts.size(); ++i) {
                Cart first = orderedCarts.get(i);
                first.doStep(points);
                for (int j = 0; j < orderedCarts.size(); ++j) {
                    if (i != j) {
                        Cart second = orderedCarts.get(j);
                        if (first.point.equals(second.point)) {
                            carts.remove(first);
                            carts.remove(second);
                        }
                    }
                }
            }
            if (carts.size() == 1) {
                return carts.get(0).point.x + "," + carts.get(0).point.y;
            }
        }
    }

    private static class Cart {
        Point point;
        Direction direction;
        int turnsCounter;

        Cart(Point point, Direction direction) {
            this.point = point;
            this.direction = direction;
        }

        void doStep(Map<Point, Character> points) {
            switch (direction) {

                case left: {
                    point = new Point(point.x - 1, point.y);
                    char ch = points.get(point);
                    left(ch);
                    break;
                }
                case right: {
                    point = new Point(point.x + 1, point.y);
                    char ch = points.get(point);
                    right(ch);
                    break;
                }
                case up: {
                    point = new Point(point.x, point.y - 1);
                    char ch = points.get(point);
                    up(ch);
                    break;
                }
                case down: {
                    point = new Point(point.x, point.y + 1);
                    char ch = points.get(point);
                    down(ch);
                    break;
                }
            }
        }

        private void left(char ch) {
            switch (ch) {
                case '\\':
                    direction = Direction.up;
                    break;
                case '/':
                    direction = Direction.down;
                    break;
                case '+':
                    switch (turnsCounter++ % 3) {
                        case 0:
                            // left
                            direction = Direction.down;
                            break;
                        case 1:
                            // straight
                            break;
                        case 2:
                            // right
                            direction = Direction.up;
                            break;
                    }
                    break;
                case '-':
                    break;
                default:
                    assert false : "unexpected " + point + " " + ch;
            }
        }

        private void right(char ch) {
            switch (ch) {
                case '\\':
                    direction = Direction.down;
                    break;
                case '/':
                    direction = Direction.up;
                    break;
                case '+':
                    switch (turnsCounter++ % 3) {
                        case 0:
                            // left
                            direction = Direction.up;
                            break;
                        case 1:
                            // straight
                            break;
                        case 2:
                            // right
                            direction = Direction.down;
                            break;
                    }
                    break;
                case '-':
                    break;
                default:
                    assert false : "unexpected " + point + " " + ch;
            }
        }

        private void up(char ch) {
            switch (ch) {
                case '\\':
                    direction = Direction.left;
                    break;
                case '/':
                    direction = Direction.right;
                    break;
                case '+':
                    switch (turnsCounter++ % 3) {
                        case 0:
                            // left
                            direction = Direction.left;
                            break;
                        case 1:
                            // straight
                            break;
                        case 2:
                            // right
                            direction = Direction.right;
                            break;
                    }
                    break;
                case '|':
                    break;
                default:
                    assert false : "unexpected " + point + " " + ch;
            }
        }

        private void down(char ch) {
            switch (ch) {
                case '\\':
                    direction = Direction.right;
                    break;
                case '/':
                    direction = Direction.left;
                    break;
                case '+':
                    switch (turnsCounter++ % 3) {
                        case 0:
                            // left
                            direction = Direction.right;
                            break;
                        case 1:
                            // straight
                            break;
                        case 2:
                            // right
                            direction = Direction.left;
                            break;
                    }
                    break;
                case '|':
                    break;
                default:
                    assert false : "unexpected " + point + " " + ch;
            }
        }
    }

    private enum Direction {
        left, right, up, down
    }
}
