package advent.advent2024

import utils.Point

private var result = 0

fun main() {
    result = test(
        """
            ###############
            #...#...#.....#
            #.#.#.#.#.###.#
            #S#...#.#.#...#
            #######.#.#.###
            #######.#.#...#
            #######.#.###.#
            ###..E#...#...#
            ###.#######.###
            #...###...#...#
            #.#####.#.###.#
            #.#...#.#.#...#
            #.#.#.#.#.#.###
            #...#...#...###
            ###############
    """.trimIndent(), 50
    )
    check(285, result)

    result = test(
        """
            ###############
            #...#...#.....#
            #.#.#.#.#.###.#
            #S#...#.#.#...#
            #######.#.#.###
            #######.#.#...#
            #######.#.###.#
            ###..E#...#...#
            ###.#######.###
            #...###...#...#
            #.#####.#.###.#
            #.#...#.#.#...#
            #.#.#.#.#.#.###
            #...#...#...###
            ###############
    """.trimIndent(), 52
    )
    check(285 - 32, result)

    result = test(
        """
            ###############
            #...#...#.....#
            #.#.#.#.#.###.#
            #S#...#.#.#...#
            #######.#.#.###
            #######.#.#...#
            #######.#.###.#
            ###..E#...#...#
            ###.#######.###
            #...###...#...#
            #.#####.#.###.#
            #.#...#.#.#...#
            #.#.#.#.#.#.###
            #...#...#...###
            ###############
    """.trimIndent(), 54
    )
    check(285 - 32 - 31, result)

    result = test(
        """
            #############################################################################################################################################
            #.....#...#...........#.........###...###.............#...#...#.......#...#.....#...#...#...###...#####.....#.......#.............###...#...#
            #.###.#.#.#.#########.#.#######.###.#.###.###########.#.#.#.#.#.#####.#.#.#.###.#.#.#.#.#.#.###.#.#####.###.#.#####.#.###########.###.#.#.#.#
            #.#...#.#.#.........#.#...#...#.....#.#...#.........#.#.#...#.#.#.....#.#...#...#.#...#.#.#.#...#...#...#...#.....#.#...#.........#...#...#.#
            #.#.###.#.#########.#.###.#.#.#######.#.###.#######.#.#.#####.#.#.#####.#####.###.#####.#.#.#.#####.#.###.#######.#.###.#.#########.#######.#
            #.#.#...#.#...#.....#.###...#.......#.#...#...#...#...#.....#.#.#.#...#.#.....###.....#...#.#.#.....#...#.###.....#.....#...........#.....#.#
            #.#.#.###.#.#.#.#####.#############.#.###.###.#.#.#########.#.#.#.#.#.#.#.###########.#####.#.#.#######.#.###.#######################.###.#.#
            #.#.#...#.#.#.#...#...#...#.........#.#...#...#.#.#...#...#.#...#...#.#.#...#...#...#.#.....#.#.###...#.#...#.....#...#...............###.#.#
            #.#.###.#.#.#.###.#.###.#.#.#########.#.###.###.#.#.#.#.#.#.#########.#.###.#.#.#.#.#.#.#####.#.###.#.#.###.#####.#.#.#.#################.#.#
            #.#.#...#...#.....#...#.#.#.........#.#.#...###.#...#...#.#...#.......#.#...#.#.#.#.#.#.#.....#.#...#.#...#...#...#.#...#...#...#.......#...#
            #.#.#.###############.#.#.#########.#.#.#.#####.#########.###.#.#######.#.###.#.#.#.#.#.#.#####.#.###.###.###.#.###.#####.#.#.#.#.#####.#####
            #.#.#.....#.........#.#.#...........#...#.#...#...#.....#.###.#.#...#...#...#.#.#.#.#.#.#.....#.#.#...#...#...#...#.......#...#...#.....#...#
            #.#.#####.#.#######.#.#.#################.#.#.###.#.###.#.###.#.#.#.#.#####.#.#.#.#.#.#.#####.#.#.#.###.###.#####.#################.#####.#.#
            #.#...###...###.....#.#.........#.....#...#.#.###...#...#...#.#...#.#...#...#.#...#...#.#.....#...#...#...#...###.#...........#.....###...#.#
            #.###.#########.#####.#########.#.###.#.###.#.#######.#####.#.#####.###.#.###.#########.#.###########.###.###.###.#.#########.#.#######.###.#
            #.#...#...#...#.....#.###...#...#.#...#...#.#.#.....#...#...#...#...#...#...#...#.......#.#...#...#...###...#.....#.........#.#.#.....#.#...#
            #.#.###.#.#.#.#####.#.###.#.#.###.#.#####.#.#.#.###.###.#.#####.#.###.#####.###.#.#######.#.#.#.#.#.#######.###############.#.#.#.###.#.#.###
            #.#...#.#.#.#.......#...#.#.#.#...#...#...#.#.#...#.#...#.#...#.#.....#...#.#...#.......#.#.#...#.#.#...#...#...............#...#.#...#.#...#
            #.###.#.#.#.###########.#.#.#.#.#####.#.###.#.###.#.#.###.#.#.#.#######.#.#.#.#########.#.#.#####.#.#.#.#.###.###################.#.###.###.#
            #...#...#.#.#.....#.....#.#.#...#...#.#...#.#...#.#.#...#.#.#.#.#.......#...#...#.......#...#...#.#.#.#.#...#.............#...#...#...#.#...#
            ###.#####.#.#.###.#.#####.#.#####.#.#.###.#.###.#.#.###.#.#.#.#.#.#############.#.###########.#.#.#.#.#.###.#############.#.#.#.#####.#.#.###
            #...#.....#...#...#.....#.#...#...#...#...#...#.#.#...#.#...#...#.....#.....#...#.#...#...#...#...#.#.#.#...#.......#...#.#.#...#.....#.#.###
            #.###.#########.#######.#.###.#.#######.#####.#.#.###.#.#############.#.###.#.###.#.#.#.#.#.#######.#.#.#.###.#####.#.#.#.#.#####.#####.#.###
            #...#.....###...#.......#...#.#.....#...#...#.#.#.#...#.......#.......#...#.#.#...#.#.#.#.#.....#...#.#.#...#.....#...#.#.#.#.....#...#.#...#
            ###.#####.###.###.#########.#.#####.#.###.#.#.#.#.#.#########.#.#########.#.#.#.###.#.#.#.#####.#.###.#.###.#####.#####.#.#.#.#####.#.#.###.#
            #...#...#...#...#.#.....#...#.#...#.#...#.#.#.#.#.#...#.......#.....###...#.#.#...#.#...#.#...#.#.#...#.....#.....#...#...#.#.......#...#...#
            #.###.#.###.###.#.#.###.#.###.#.#.#.###.#.#.#.#.#.###.#.###########.###.###.#.###.#.#####.#.#.#.#.#.#########.#####.#.#####.#############.###
            #.#...#...#.....#.#...#.#...#...#...#...#.#.#.#...#...#...........#...#...#.#.#...#.#...#...#...#.#...#.......#...#.#.#...#...#...........###
            #.#.#####.#######.###.#.###.#########.###.#.#.#####.#############.###.###.#.#.#.###.#.#.#########.###.#.#######.#.#.#.#.#.###.#.#############
            #.#.#####...#...#...#.#.###.........#.###.#...#.....###...#...###...#.#...#...#...#.#.#.#.....#...#...#.....###.#.#.#.#.#.....#.......#...###
            #.#.#######.#.#.###.#.#.###########.#.###.#####.#######.#.#.#.#####.#.#.#########.#.#.#.#.###.#.###.#######.###.#.#.#.#.#############.#.#.###
            #.#...#...#...#...#.#.#...#...#.....#...#.....#...#...#.#.#.#.#...#.#.#...#...#...#...#...#...#.#...#.......#...#...#.#.#...........#...#...#
            #.###.#.#.#######.#.#.###.#.#.#.#######.#####.###.#.#.#.#.#.#.#.#.#.#.###.#.#.#.###########.###.#.###.#######.#######.#.#.#########.#######.#
            #.....#.#.........#...#...#.#.#.....#...#...#.#...#.#.#.#.#.#.#.#.#.#.###.#.#...#...###...#.#...#...#.###...#.#.....#...#.........#.#.......#
            #######.###############.###.#.#####.#.###.#.#.#.###.#.#.#.#.#.#.#.#.#.###.#.#####.#.###.#.#.#.#####.#.###.#.#.#.###.#############.#.#.#######
            ###...#.......#...#...#.....#.....#.#.....#...#.#...#.#.#.#.#.#.#.#.#.#...#.#.....#...#.#.#.#.#...#.#.#...#...#...#.......#.......#...#...###
            ###.#.#######.#.#.#.#.###########.#.###########.#.###.#.#.#.#.#.#.#.#.#.###.#.#######.#.#.#.#.#.#.#.#.#.#########.#######.#.###########.#.###
            #...#...#...#...#...#...#...#...#.#.........#...#...#...#.#.#.#.#.#.#...#...#.......#.#.#.#.#.#.#.#.#...#.........#.....#.#...#...#.....#...#
            #.#####.#.#.###########.#.#.#.#.#.#########.#.#####.#####.#.#.#.#.#.#####.#########.#.#.#.#.#.#.#.#.#####.#########.###.#.###.#.#.#.#######.#
            #.#...#...#.............#.#...#.#.......#...#...#...#.....#.#...#.#.....#...#...#...#.#.#.#.#.#.#.#...#...#...###...#...#...#...#...#...#...#
            #.#.#.###################.#####.#######.#.#####.#.###.#####.#####.#####.###.#.#.#.###.#.#.#.#.#.#.###.#.###.#.###.###.#####.#########.#.#.###
            #.#.#.#...#...............#...#.......#.#...###.#...#...#...#...#.#.....###...#.#.#...#.#.#.#.#.#.#...#.....#...#.#...#...#.........#.#...###
            #.#.#.#.#.#.###############.#.#######.#.###.###.###.###.#.###.#.#.#.###########.#.#.###.#.#.#.#.#.#.###########.#.#.###.#.#########.#.#######
            #...#...#...###...#.......#.#.........#...#...#.#...###.#.#...#...#.........#...#.#.#...#...#.#.#.#.#.........#...#.#...#.....#...#...#...###
            ###############.#.#.#####.#.#############.###.#.#.#####.#.#.###############.#.###.#.#.#######.#.#.#.#.#######.#####.#.#######.#.#.#####.#.###
            #...............#.#.....#.#.........#...#.....#.#.#...#...#.#.....#...#.....#.#...#.#.#.......#.#...#.....###.....#...#.......#.#.......#...#
            #.###############.#####.#.#########.#.#.#######.#.#.#.#####.#.###.#.#.#.#####.#.###.#.#.#######.#########.#######.#####.#######.###########.#
            #.....#.....#...#.....#.#.###.......#.#.###...#...#.#...#...#...#.#.#.#.....#.#.###.#.#.#.....#.#.......#.......#...#...#...#...#...........#
            #####.#.###.#.#.#####.#.#.###.#######.#.###.#.#####.###.#.#####.#.#.#.#####.#.#.###.#.#.#.###.#.#.#####.#######.###.#.###.#.#.###.###########
            #.....#.###...#.#...#...#.....#.......#.....#.......#...#...#...#.#.#...#...#.#...#...#...###.#.#.....#.#...#...#...#...#.#...#...#...#...###
            #.#####.#######.#.#.###########.#####################.#####.#.###.#.###.#.###.###.###########.#.#####.#.#.#.#.###.#####.#.#####.###.#.#.#.###
            #.....#.#.......#.#.............###...#...#...#.......#.....#...#.#...#.#...#...#...#...#...#...#.....#...#...###.....#...#...#.....#...#...#
            #####.#.#.#######.#################.#.#.#.#.#.#.#######.#######.#.###.#.###.###.###.#.#.#.#.#####.###################.#####.#.#############.#
            #...#.#.#.........#...#.............#...#...#.#.......#.....#...#.#...#.#...###.#...#.#...#.#...#.........#.........#...#...#...#.......#...#
            #.#.#.#.###########.#.#.#####################.#######.#####.#.###.#.###.#.#####.#.###.#####.#.#.#########.#.#######.###.#.#####.#.#####.#.###
            #.#.#...#.....#.....#...#...................#.........#.....#.###.#...#...#...#...###.....#...#.#.......#...#.......###...#...#...#...#...###
            #.#.#####.###.#.#########.#################.###########.#####.###.###.#####.#.###########.#####.#.#####.#####.#############.#.#####.#.#######
            #.#.#...#...#.#...........#.................#.......###.....#...#...#.......#.#...###...#.#.....#...#...#.....#...#.....#...#...#...#.......#
            #.#.#.#.###.#.#############.#################.#####.#######.###.###.#########.#.#.###.#.#.#.#######.#.###.#####.#.#.###.#.#####.#.#########.#
            #.#...#.#...#...###...#...#...................#...#.......#.#...###.#.....#...#.#.#...#...#.....#...#.....#.....#...#...#.#.....#.#.........#
            #.#####.#.#####.###.#.#.#.#####################.#.#######.#.#.#####.#.###.#.###.#.#.###########.#.#########.#########.###.#.#####.#.#########
            #.....#.#.#...#.#...#...#.........#.....#...#...#.....#...#.#...#...#...#.#...#.#...#.........#.#...#.......#.........#...#.#...#.#.###.....#
            #####.#.#.#.#.#.#.###############.#.###.#.#.#.#######.#.###.###.#.#####.#.###.#.#####.#######.#.###.#.#######.#########.###.#.#.#.#.###.###.#
            #.....#.#...#.#...#.............#...###.#.#.#.......#.#.#...#...#.......#.#...#.#.....#...#...#.....#.#.....#.#...#...#...#...#...#...#.#...#
            #.#####.#####.#####.###########.#######.#.#.#######.#.#.#.###.###########.#.###.#.#####.#.#.#########.#.###.#.#.#.#.#.###.###########.#.#.###
            #.#...#.......#...#.#.....#.....#.....#.#.#.#...#...#...#.....###...#...#...###...#.....#...#...#...#.#...#.#...#...#.....#...#.....#...#...#
            #.#.#.#########.#.#.#.###.#.#####.###.#.#.#.#.#.#.###############.#.#.#.###########.#########.#.#.#.#.###.#.###############.#.#.###.#######.#
            #.#.#...#.....#.#...#...#.#...#...#...#...#...#.#.................#...#...#...#.....#...#...#.#.#.#.#...#.#.......#.......#.#...###.#.......#
            #.#.###.#.###.#.#######.#.###.#.###.###########.#########################.#.#.#.#####.#.#.#.#.#.#.#.###.#.#######.#.#####.#.#######.#.#######
            #.#.###...###...###...#.#.....#...#.......#...#.......#.....#.....#.......#.#.#.....#.#...#.#.#...#.....#.......#.#.....#.#.......#.#.......#
            #.#.###############.#.#.#########.#######.#.#.#######.#.###.#.###.#.#######.#.#####.#.#####.#.#################.#.#####.#.#######.#.#######.#
            #...#.......#...#...#...#.....#...#.......#.#.#...###.#...#.#...#...###...#.#.#...#...#.....#.#...#.............#...#...#.........#.#.......#
            #####.#####.#.#.#.#######.###.#.###.#######.#.#.#.###.###.#.###.#######.#.#.#.#.#.#####.#####.#.#.#.###############.#.#############.#.#######
            #...#.....#.#.#.#...#.....#...#...#.#.......#...#...#.#...#...#.#...#...#...#...#.....#.......#.#.#...............#.#.....#...#.....#...#...#
            #.#.#####.#.#.#.###.#.#####.#####.#.#.#############.#.#.#####.#.#.#.#.###############.#########.#.###############.#.#####.#.#.#.#######.#.#.#
            #.#.......#...#.....#.....#.....#.#...#.............#.#.#...#.#...#.#S###############.#...#.....#.................#.......#.#.#...#.....#.#.#
            #.#######################.#####.#.#####.#############.#.#.#.#.#####.#################.#.#.#.###############################.#.###.#.#####.#.#
            #.............#...#...#...#...#...#...#.............#.#.#.#.#.......#################...#...#.....#...........#.............#...#.#.......#.#
            #############.#.#.#.#.#.###.#.#####.#.#############.#.#.#.#.#################################.###.#.#########.#.###############.#.#########.#
            #...........#.#.#.#.#...#...#.......#.....#.........#...#.#.#...#.....#######################E###...###.....#...#.....#...#.....#...........#
            #.#########.#.#.#.#.#####.###############.#.#############.#.#.#.#.###.#################################.###.#####.###.#.#.#.#################
            #.#...#...#.#...#...#...#...............#.#.......#...#...#...#.#.#...#########################...#...#...#.......###...#...#...............#
            #.#.#.#.#.#.#########.#.###############.#.#######.#.#.#.#######.#.#.###########################.#.#.#.###.###################.#############.#
            #...#...#.#...........#.....#...........#.........#.#.#...#.....#.#...#################.........#...#...#.................###.#.............#
            #########.#################.#.#####################.#.###.#.#####.###.#################.###############.#################.###.#.#############
            #.........#.....#.........#.#.......#...###...#...#.#...#.#.#...#.#...#...###.....#####.............#...#...#.............#...#.............#
            #.#########.###.#.#######.#.#######.#.#.###.#.#.#.#.###.#.#.#.#.#.#.###.#.###.###.#################.#.###.#.#.#############.###############.#
            #.#...#...#.###...###.....#.........#.#.....#...#...#...#.#...#...#.#...#.#...#...#.................#.....#.#.#...###.....#...#.....#.......#
            #.#.#.#.#.#.#########.###############.###############.###.#########.#.###.#.###.###.#######################.#.#.#.###.###.###.#.###.#.#######
            #...#...#...#...#...#.........#.......#...............#...#.........#...#.#.#...###...#.............#.....#...#.#.....#...#...#...#...#.....#
            #############.#.#.#.#########.#.#######.###############.###.###########.#.#.#.#######.#.###########.#.###.#####.#######.###.#####.#####.###.#
            #...#.........#.#.#.#.......#...#.......#...#...#...###...#...#...#.....#...#.....###...#...#.......#.#...#.....#.....#.....#...#.......#...#
            #.#.#.#########.#.#.#.#####.#####.#######.#.#.#.#.#.#####.###.#.#.#.#############.#######.#.#.#######.#.###.#####.###.#######.#.#########.###
            #.#.#.........#...#.#.#...#...###...#.....#...#...#.....#.#...#.#.#...#.....#.....#.....#.#.#.........#.....#...#...#.#...#...#.#.........###
            #.#.#########.#####.#.#.#.###.#####.#.#################.#.#.###.#.###.#.###.#.#####.###.#.#.#################.#.###.#.#.#.#.###.#.###########
            #.#.#...#...#...#...#...#...#.#...#.#...#...#.....#...#.#.#...#.#...#.#...#...#...#.#...#.#.#.....#...#.......#.....#...#.#...#.#...........#
            #.#.#.#.#.#.###.#.#########.#.#.#.#.###.#.#.#.###.#.#.#.#.###.#.###.#.###.#####.#.#.#.###.#.#.###.#.#.#.#################.###.#.###########.#
            #.#...#...#.....#...........#...#.#.....#.#.#...#...#.#.#.#...#...#.#.#...###...#.#.#.#...#.#.#...#.#.#.................#...#.#.#.......#...#
            #.###############################.#######.#.###.#####.#.#.#.#####.#.#.#.#####.###.#.#.#.###.#.#.###.#.#################.###.#.#.#.#####.#.###
            #.#.............#...............#.#...#...#.....#...#...#.#.#...#.#...#...#...#...#.#.#...#.#.#.#...#...#...#.....#...#...#...#.#.###...#...#
            #.#.###########.#.#############.#.#.#.#.#########.#.#####.#.#.#.#.#######.#.###.###.#.###.#.#.#.#.#####.#.#.#.###.#.#.###.#####.#.###.#####.#
            #.#...#.........#...#...........#...#...#...#...#.#...#...#.#.#.#.#.......#...#.#...#.#...#.#.#.#.....#.#.#...###.#.#.....#.....#...#.#.....#
            #.###.#.###########.#.###################.#.#.#.#.###.#.###.#.#.#.#.#########.#.#.###.#.###.#.#.#####.#.#.#######.#.#######.#######.#.#.#####
            #.#...#.....#...#...#.......#...#...#...#.#.#.#.#.#...#...#.#.#.#.#.#...#####.#.#...#.#...#.#.#.#...#.#.#.......#...#...###.....#...#.#...###
            #.#.#######.#.#.#.#########.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#####.#.###.#.###.#.#.#.#.#.#.#.#######.#####.#.#######.#.###.###.###
            #...#.......#.#.#.#.........#.#...#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.#...#...#...#.#...#.#.#.#.#.#.#.#...#...#.......#...#...#...###...#...#
            #####.#######.#.#.#.#########.#####.#.#.#.#.#.#######.#.###.#.#.#.#.#.###.#.#####.#.###.#.#.#.#.#.#.#.###.#.#.###########.#.#.#########.###.#
            #.....#.......#...#...#...#...#.....#.#.#.#.#...#####.#...#.#.#.#.#.#...#.#...###.#.###.#.#.#.#.#.#...#...#.#...#...#...#...#.#...#...#.....#
            #.#####.#############.#.#.#.###.#####.#.#.#.###.#####.###.#.#.#.#.#.###.#.###.###.#.###.#.#.#.#.#.#####.###.###.#.#.#.#.#####.#.#.#.#.#######
            #.......#.............#.#...###.....#.#.#.#...#...#...#...#.#.#.#.#...#.#...#...#.#...#.#.#.#.#.#.....#...#...#...#...#...#...#.#...#.......#
            #########.#############.###########.#.#.#.###.###.#.###.###.#.#.#.###.#.###.###.#.###.#.#.#.#.#.#####.###.###.###########.#.###.###########.#
            #.....###.#...........#.#...###.....#.#.#.#...#...#...#.#...#.#.#.#...#...#.#...#.#...#.#.#...#.#...#...#...#...........#.#.....#...#.......#
            #.###.###.#.#########.#.#.#.###.#####.#.#.#.###.#####.#.#.###.#.#.#.#####.#.#.###.#.###.#.#####.#.#.###.###.###########.#.#######.#.#.#######
            #...#.....#.#.........#...#...#.....#.#...#...#.....#...#...#.#.#.#.#...#.#.#.###.#.#...#.....#...#.#...#...#...#.....#.#...#...#.#.#...#...#
            ###.#######.#.###############.#####.#.#######.#####.#######.#.#.#.#.#.#.#.#.#.###.#.#.#######.#####.#.###.###.#.#.###.#.###.#.#.#.#.###.#.#.#
            ###.....#...#.#...#...#...#...#.....#.###.....#.....#.......#.#...#.#.#.#.#.#...#.#.#...#.....#.....#.###.#...#.#...#...###...#...#...#...#.#
            #######.#.###.#.#.#.#.#.#.#.###.#####.###.#####.#####.#######.#####.#.#.#.#.###.#.#.###.#.#####.#####.###.#.###.###.#################.#####.#
            #.......#.#...#.#...#.#.#...###.......#...#...#...#...#.....#.....#.#.#.#.#...#.#.#.#...#.....#.....#.#...#...#...#.....#.......#.....#...#.#
            #.#######.#.###.#####.#.###############.###.#.###.#.###.###.#####.#.#.#.#.###.#.#.#.#.#######.#####.#.#.#####.###.#####.#.#####.#.#####.#.#.#
            #.#...#...#.#...#.....#...#.............#...#.#...#...#.#...#...#.#.#.#.#...#.#.#.#.#...#.....###...#.#.#...#.#...#...#...#...#.#...#...#.#.#
            #.#.#.#.###.#.###.#######.#.#############.###.#.#####.#.#.###.#.#.#.#.#.###.#.#.#.#.###.#.#######.###.#.#.#.#.#.###.#.#####.#.#.###.#.###.#.#
            #...#...#...#.###.....#...#...#...#.....#...#...#...#.#.#...#.#...#.#.#.....#.#.#.#...#.#.#...#...#...#.#.#...#...#.#.......#.#...#.#...#...#
            #########.###.#######.#.#####.#.#.#.###.###.#####.#.#.#.###.#.#####.#.#######.#.#.###.#.#.#.#.#.###.###.#.#######.#.#########.###.#.###.#####
            ###...#...#...#.......#...#...#.#.#...#.#...###...#...#.#...#...#...#.....#...#.#.#...#...#.#...#...#...#...#.....#.........#.#...#...#.#...#
            ###.#.#.###.###.#########.#.###.#.###.#.#.#####.#######.#.#####.#.#######.#.###.#.#.#######.#####.###.#####.#.#############.#.#.#####.#.#.#.#
            #...#...#...#...#.....#...#...#.#...#.#...#.....#...#...#.#...#.#.#...#...#.#...#.#.#.......#...#...#.#...#.#.....#...#...#.#...#...#...#.#.#
            #.#######.###.###.###.#.#####.#.###.#.#####.#####.#.#.###.#.#.#.#.#.#.#.###.#.###.#.#.#######.#.###.#.#.#.#.#####.#.#.#.#.#.#####.#.#####.#.#
            #.#.....#.###.#...#...#.#...#.#...#.#.....#.#...#.#.#...#...#.#.#.#.#...###.#...#.#.#...#.....#.#...#.#.#.#...###...#.#.#...###...#...#...#.#
            #.#.###.#.###.#.###.###.#.#.#.###.#.#####.#.#.#.#.#.###.#####.#.#.#.#######.###.#.#.###.#.#####.#.###.#.#.###.#######.#.#######.#####.#.###.#
            #.#.#...#.#...#...#...#.#.#...#...#...#...#...#.#.#.#...#...#...#.#.......#.#...#...#...#.#...#.#...#.#.#...#.#.......#.#...#...#...#...#...#
            #.#.#.###.#.#####.###.#.#.#####.#####.#.#######.#.#.#.###.#.#####.#######.#.#.#######.###.#.#.#.###.#.#.###.#.#.#######.#.#.#.###.#.#####.###
            #...#.....#.#...#...#...#.....#...#...#.....#...#.#.#.....#...#...#...#...#...###...#...#.#.#...#...#...###...#.......#...#...#...#...#...###
            ###########.#.#.###.#########.###.#.#######.#.###.#.#########.#.###.#.#.#########.#.###.#.#.#####.###################.#########.#####.#.#####
            #...........#.#.#...###...#...#...#...#.....#.....#.#.......#.#...#.#...#.......#.#...#...#.....#.............###.....#.....#...#...#...#...#
            #.###########.#.#.#####.#.#.###.#####.#.###########.#.#####.#.###.#.#####.#####.#.###.#########.#############.###.#####.###.#.###.#.#####.#.#
            #.#.....#.....#...###...#...#...#...#...###.........#...###.#...#.#.......#...#.#...#.#.........#...#.........#...#...#...#.#.###.#.#...#.#.#
            #.#.###.#.###########.#######.###.#.#######.###########.###.###.#.#########.#.#.###.#.#.#########.#.#.#########.###.#.###.#.#.###.#.#.#.#.#.#
            #.#.#...#...#.........#.....#.....#.......#...#...#...#.#...#...#...#...#...#.#.#...#...#...#...#.#.#.........#...#.#.#...#.#.....#...#...#.#
            #.#.#.#####.#.#########.###.#############.###.#.#.#.#.#.#.###.#####.#.#.#.###.#.#.#######.#.#.#.#.#.#########.###.#.#.#.###.###############.#
            #...#.......#...........###...............###...#...#...#.....#####...#...###...#.........#...#...#...........###...#...###.................#
            #############################################################################################################################################
    """.trimIndent(), 100
    )
    check(1011325, result)
}

private fun test(input: String, savedSeconds: Int): Int {
    val map = input.split("\n")
    val height = map.size
    val width = map[0].length
    var start: Point? = null
    var end: Point? = null

    for (x in 0..<height) {
        for (y in 0..<width) {
            val char = map[x][y]
            if (char == 'S') {
                start = Point(x, y)
                if (end != null) break
            } else if (char == 'E') {
                end = Point(x, y)
                if (start != null) break
            }
        }
        if (start != null && end != null) break
    }

    val startPoint = start!!
    val endPoint = end!!

    fun Point.isInsideMap(): Boolean {
        return x in 0..<width && y in 0..<height
    }

    data class State(val point: Point) {
        var path = emptyList<Point>()
    }

    fun State.generateNext(): Set<State> {
        val results = mutableSetOf<State>()
        val set = setOf(Point(0, 1), Point(1, 0), Point(0, -1), Point(-1, 0))
        for (delta in set) {
            val next = Point(point.x + delta.x, point.y + delta.y)
            if (next.isInsideMap() && map[next.x][next.y] in setOf('.', 'E')) {
                val prevPath = path
                results += State(next).apply {
                    path = mutableListOf()
                    path += prevPath
                    path += next
                }
            }
        }
        return results
    }

    fun bfs(): Pair<Int, State> {
        var opened = mutableSetOf(State(startPoint).apply { path = listOf(startPoint) })
        val closed = mutableSetOf<State>()
        var steps = 0
        while (opened.isNotEmpty()) {
            val achievable = mutableSetOf<State>()
            for (current in opened) {
                if (current.point == endPoint) {
                    return steps to current
                }
                val set = current.generateNext()
                for (next in set) {
                    if (next !in closed) {
                        achievable += next
                    }
                }
                closed += current
            }
            opened = achievable
            ++steps
        }
        return -1 to State(startPoint)
    }

    val (steps, endState) = bfs()
    val path = endState.path
    println("steps=$steps path=$path")

    var sum = 0
    for (i in 0..<path.lastIndex) {
        for (j in i + 1..path.lastIndex) {
            val p1 = path[i]
            val p2 = path[j]
            val distance = p2.manhattanDistance(p1)
            if (distance <= 20) {
                if (j - i - distance >= savedSeconds) {
                    ++sum
                }
            }
        }
    }

    return sum
}
