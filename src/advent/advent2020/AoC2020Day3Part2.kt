package advent.advent2020

private fun test(input: String): Long {
    val entries = input.split("\n").map { it.toCharArray() }
    return trees(entries, 1, 1) *
            trees(entries, 3, 1) *
            trees(entries, 5, 1) *
            trees(entries, 7, 1) *
            trees(entries, 1, 2)
}

private fun trees(entries: List<CharArray>, right: Int, down: Int): Long {
    val size = entries[0].size
    val rowsCount = entries.size
    var x = 0
    var y = 0
    var count = 0L
    while (true) {
        if (y >= rowsCount) {
            return count
        }
        if (entries[y][x] == '#') {
            ++count
        }
        x += right
        y += down
        x %= size
    }
}

fun main() {
    test()
}

private var result: Long = 0

private fun test() {
    result = test("""
        ..##.......
        #...#...#..
        .#....#..#.
        ..#.#...#.#
        .#...##..#.
        ..#.##.....
        .#.#.#....#
        .#........#
        #.##...#...
        #...##....#
        .#..#...#.#
    """.trimIndent())
    check(336, result)

    result = test("""
        ....#...............##...#...#.
        #...#..#.....##.##.#.##....#...
        ...#.....#...#.................
        #..#..#.......#...#.#..........
        ...##..#.#..........##...#.....
        ........###.#.##..#............
        ...###......##.#..#.#...#.#....
        ......##..#.#....#...#.........
        .................#......#......
        ..............##....#..........
        #.....................#...#.#.#
        .##..#............##...##.##..#
        .....#.####...#..##......#.#..#
        #.......#.#..#......##.#.#....#
        .....##...###.#..........##....
        #...........#.##....##.....#..#
        ..###..##.##.....#....#........
        ...#.#.#............#.#..#....#
        #......#....#...##.#.#.#.#..#..
        .......#.#...#..#..#..##......#
        .....#..#.............#..#...#.
        ##..#.##.....#........#........
        ....##....#..#...........#...#.
        .......#........##.......##....
        ..##...#.......#........##.#...
        ..........#..#.....##........#.
        ..#..##..#............#........
        .#.#...#...#.......#......#....
        ....#....#.....#.#.........###.
        .............#...#....#..#.#...
        ##.#...#..#......#.#.##.....#..
        #...##.#..........#..#.#...#...
        #####.......#.#.....#..#.......
        #...#...#........#....#...#....
        ......##.#..#..#............#..
        ....#....#.......#...###.......
        .#......##...#.##....#...#.....
        ..#....#...##.....#.#...##.#...
        #.......#........#.####........
        #.##..#..#.........#.#........#
        .#...#.#.#.#......#....#.#..#..
        #...####...##.##.#....#......##
        ..#...#......##........#.....#.
        ...#.#....##...................
        ...##................#.........
        ...##.....##........#....#..#..
        .........#..#.....#............
        .#..#.......................#..
        .#.........#..##........#.#.#.#
        ......#.....##..#.##...#..#.##.
        ..#..............##.......#....
        ...............##....#...##..#.
        ###...#..###.........#...#.....
        ...#..#...#....#.....##........
        ....#..##...#........#.........
        ..#......#.......#.....#..#....
        .#...........##.....###....#...
        .#..#.....##.........##.....#..
        ....##.#.....#................#
        ..#..#......#.#..#....#..##....
        #.....#...##............#......
        .#.............#....#.......#..
        #.........#..#...##.#...#.#.##.
        ...#......#..####....#.#.....#.
        ......#........#..........##.##
        ......##.#..##.##.....#........
        ##.....#..##.##..#.......##....
        .##.........#...........#...#..
        .....#...###..#...#...........#
        ..........#.#......#.###.....#.
        ...#.............#.##......##..
        #.##.........#..###...........#
        ....#..##....#..#..#........###
        ...#........##.......##..#..#..
        ...#......#..#.#...............
        #......###....#.#..#.#..#....#.
        #.#.####.#.........#..#.#.#....
        .....#....#...............#...#
        .#........#......#.#...#.......
        ................#...#.....##...
        .............#...####..........
        .................##....##.###..
        #................#......#......
        .###.#........#..##.....#..###.
        ..#.#..#...#..#.#...#.#.....#.#
        .....#............#..##..#..#.#
        #........##.#...#.....#........
        #.#.#..###......###............
        ...#..#...........##...#.....#.
        ......#........#...#.#....#....
        ....#..........#.#..#.#....##..
        ...#.....##..#......#.#.##...#.
        .........#..#................#.
        ..#....#.##.....#.......#......
        ...#.....#.......##.##.....#...
        #...#..............#..###..#...
        #.#......#.#....#........##..#.
        ...#...##...##..#.........#....
        ..#...#......##.#.#.#....##....
        #.......#.......#..#..#........
        .........#..#.....#....#.....##
        .#......#.......#.#..#..#...#.#
        ..#....#.#..#..................
        #.....####..........#.#.....#.#
        .#..#.#.#....#.#.....#.#.......
        ....##......#..#.....#.#.#...#.
        ...##...#......##.#....##.#....
        ..#..##....#...#...........#...
        .......#........#...##.#.......
        #.#..#....##.#....##...........
        .......#............#..##..##..
        #.#.#.....#....##.#.#.#.....#..
        ##...#...#.......#..#...#.....#
        ##..##.##..........#........##.
        ..............#.....#..#..##...
        .......#...#.........#....#.#..
        ...#..#..#....#.#....##........
        ..#.......#....#....##.........
        #...#.....#..#.#...##....#.....
        .....##..#..##..#..............
        .....##............#....#.#....
        ..#.....#....##.#.....#..#.....
        #...#..#..#......#.#.#..##.....
        .............................##
        #...#.#................#....#.#
        .#.#.#....##......###..##......
        #.....#..#.##.#.#.##...###.....
        .........#............##..#....
        .#..#...#....#.....#.#........#
        ...............#......#..#.....
        ...................###........#
        .###..##..##.......#.#.........
        #.........#......#....#.#...#..
        .#.#....#.......#.#..##...##...
        .#.....#....##.......#.#.....#.
        .........#...#....#.#..........
        ....###..#..##.#...##....#..#..
        ...#.#..##.#.........###.#..#..
        #...#...........#....#.........
        ....##...........#.#.#......###
        #....#...........##..#.........
        ###....#.....#.......#....###..
        .#.......#....#.#.#.#......#.#.
        ........#...............#.#.#..
        ....#.........#.....#...##.##.#
        ...#............#.............#
        ..........#..#.................
        ........#.....##............#.#
        ..#...##........#...#.....#.#..
        ....#........#.#.#..........#..
        #.#...#...........#............
        ....#.#...##...........#.....#.
        ...........#.#..#.....#........
        .....#..#..#..#.....#.#.....#.#
        #.....#.......#.......#...#....
        #.........#....#.#........#..#.
        ...#..#.........#.....#..#.....
        ...#..#.............#..........
        .#.......#..........#.....#...#
        .....#.#......#.......#....#...
        ...#.....#..#..##....##....#...
        .#.#.#..#...#.....#....#.......
        ..##.#..........#.....#.#......
        ..#..#.............#...##..##..
        .#.............#..#....##...#..
        ..#...#.....#.................#
        ..##.......#.....#...#....#....
        .#..#.##.........#...#.#...#...
        ...##.......##..#.....##.##...#
        ........####.#.........#.......
        ..#.#...##.#..#..#.......##.#..
        .#..#............###..#..#.....
        #.....#.#...#.#.......#........
        ..........#......#.#...#...#...
        ..#......#..#..#.#...#.........
        ..###........#.#....#.#...##...
        .#.....#..#.#......#........#..
        .#...#..#...#....#.......#..#..
        ..#....#..#.....#.#........#...
        #..#.#.........#..........#..#.
        .#.....##....#.........#.#.#.#.
        #.#...#.....#.#.#....#.#..#....
        .........#...................#.
        ..#.....#..##...#..........#.#.
        ..............#....#.........#.
        .#....#.....#..............##..
        #...#...#.#........##.........#
        ....###....#.#....#.#.........#
        .....#........#.....##.........
        .#...##..##..#.........##......
        ............#.....#........#...
        ..#....#.......#......#..#.#.#.
        #.......#.#...........#..##.#..
        ......#.##......#....#.......#.
        .....#........#...###.....#....
        ###..........#........#.#.#....
        .....#...#.#...#...#...##.....#
        .##...#.#........#.#....#......
        ......#.........#.....#.#......
        .....#.##.....###.#...#...##..#
        .#.#.......##....#..#..#.##....
        .####...###.#.#.#.#............
        ......#..##...#..........#.##.#
        ......#............#...........
        .....#.#..#.......##...##......
        ......#........#..#....#.#.#.#.
        #..#..#.....#..#.....#.......#.
        .#...#.....#..............#....
        .#....#..#.##.#............####
        ..........#....#.##...#.#......
        ...#.#.#.#.#.......#.........#.
        ##........#..##..#.........#...
        ..#......#...#..#.#.....#......
        ..#.#......#...#...#.#.........
        ........................##.....
        ...#.##.#........#...#.......#.
        ..#.#......#....##........#.#..
        #......#.##........#..#......#.
        .....#..#..#.............#.....
        ......#......#........#....#...
        ...#....###.....#..#.#....#....
        #.......................#....#.
        ..#...#...................#....
        ....#..#.....##.#..#...#.....#.
        ...#.........#...#.......#.....
        ..#....#.....#...#...#.#####...
        .....####......#...........#...
        ......#.#..........#...#.#.#..#
        ###..#.#....#..#...............
        ...#...###..#..#.#.#...........
        .....#...#.##.#.#.###..##......
        .........#...........#....##.#.
        ....#..#......#................
        ...........#..#..#...#.#.......
        ..#.....#......##.###..........
        .........#...................#.
        ..........#...#.#....##........
        ..#...##....#....#.......#...##
        #......#.....#...#...#...#.....
        ....##...#.#.......#.#...##....
        ...#.....#....#.....#....#.....
        #....##.....##..##..........##.
        .....#.....#.#.#...............
        .#.##....#.....#.#..#....#..##.
        .....#.#.....##....#...........
        .........#..#.......##..##.....
        ..#....##.....###...#....#.#...
        ............#......#.#...#..#..
        #..##......#.#.##....#.#.......
        .#.#.....#...#.#.#....#.....#..
        #....#..#.#....#...#...........
        ......#.#.....#...#.#.#......#.
        ###..#....#.###.............#..
        ..............#####........###.
        ..#..#.#.#.#......#......#.....
        ###.........#.#..........#..#.#
        .#.........#...#......####.....
        ..#.......####..#....#...#..#..
        #.#..#.#...............#.#.#.#.
        ###....#.....##.#....#......##.
        ..#..#........#....###.#.#.....
        ...#.#..........#.....#...#....
        ....#......##.#............#..#
        ...##...#.....#..##....#..#.#.#
        .......#.....#..#....#....##.#.
        .#..#....#..#......##....##...#
        ..#......#...#.#..###..#.##....
        #...#.....#......##...#.......#
        .....#.#.....#...##............
        .#..##.##..#..##.#........#....
        ....#.#......##...#.#.#.#..##..
        .#..............##........#....
        .##....#..#..#....#...#......#.
        ............###....##.......##.
        ..............####.....#.......
        ........##..##.#...#.......#...
        ....#..#.....##.......#####...#
        .##..##..#.....#...#..#..#....#
        ##..#.#.#...........#..........
        #..#......#...#....#...........
        ...#..##.#..........#..#.......
        ........#.#.....#......##......
        .....#....#............#.......
        .#.#..#....##......#.......###.
        .#..#.#........#......#...##..#
        ...#....#......#..#........#.##
        .........#..#...#..#.#.##......
        ....###.#...........#...#......
        .##............#.......#..##...
        ##...#.#...............#.#...##
        ..#..#.....#.#..#..#...........
        ..#..#.##..#......#.##..#.#....
        ..#...#......#.#...#....##.#...
        ...###....####......#....#...#.
        .......##........#.....##....#.
        .........##..........#...#.....
        .....#............#.##.#....#.#
        ..........#...#....##..........
        ....................#......#...
        #......#..#...#.............##.
        ...........#...................
        ..#...#.........#.##.#..##.#...
        #.#....#.#.....#............#..
        .#..#.....#.....####......#.#..
        #....#.......##..#...........#.
        ............#...#.....#..#.#...
        #...........#...#####....#...#.
        ..........#...###..##.........#
        #.....###............#..#..#.#.
        ...##.....#....#......#.....#..
        #....#.......#..#......###...#.
        ...##.##......##..##..........#
        .......#.#..#.#..#.#.#.#..#..#.
        ..#..###...#....#.....#......#.
        ...#.........#..#.##.#.....###.
        ..#.........#.##.#..#..#..###..
        ..####..#.........#.........#.#
        ..#.#...#.......#....##........
        .#......#.#....................
        ..........#.......#.#..#..#....
        ..#........#....#.#..#.........
        ..#.....#.............#....#...
        ##...#.........#.....#...#.....
    """.trimIndent())
    check(2431272960, result)
}
