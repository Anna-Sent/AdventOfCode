package advent.advent2023

import utils.Point
import utils.plus

private var result = 0

fun main() {
    result = test(
        """
            #.#####################
            #.......#########...###
            #######.#########.#.###
            ###.....#.>.>.###.#.###
            ###v#####.#v#.###.#.###
            ###.>...#.#.#.....#...#
            ###v###.#.#.#########.#
            ###...#.#.#.......#...#
            #####.#.#.#######.#.###
            #.....#.#.#.......#...#
            #.#####.#.#.#########v#
            #.#...#...#...###...>.#
            #.#.#v#######v###.###v#
            #...#.>.#...>.>.#.###.#
            #####v#.#.###v#.#.###.#
            #.....#...#...#.#.#...#
            #.#########.###.#.#.###
            #...###...#...#...#.###
            ###.###.#.###v#####v###
            #...#...#.#.>.>.#.>.###
            #.###.###.#.###.#.#v###
            #.....###...###...#...#
            #####################.#
    """.trimIndent()
    )
    check(154, result)

    result = test(
        """
            #.###########################################################################################################################################
            #.#...#...#.........#...#...###...###...###...#...###...#.....###...........#.....#...........#...#...###...###...#...#...#.....#...#...#####
            #.#.#.#.#.#.#######.#.#.#.#.###.#.###.#.###.#.#.#.###.#.#.###.###.#########.#.###.#.#########.#.#.#.#.###.#.###.#.#.#.#.#.#.###.#.#.#.#.#####
            #.#.#.#.#.#.#.......#.#...#.#...#.....#.#...#.#.#...#.#.#.#...#...#.........#.#...#.........#...#.#.#.#...#.#...#.#.#.#.#.#...#.#.#...#.....#
            #.#.#v#.#.#.#.#######.#####.#.#########.#.###.#.###.#.#.#.#.###.###.#########.#.###########.#####.#.#.#.###.#.###.#.#.#.#.###.#.#.#########.#
            #.#.#.>.#...#...#...#.#.....#.........#.#...#.#.#...#.#.#.#.###...#.#.........#.#...###...#...#...#.#.#.#...#...#.#.#.#.#...#.#.#.#...#.....#
            #.#.#v#########.#.#.#.#.#############.#.###.#.#.#.###.#.#.#.#####.#.#.#########.#.#.###.#.###.#.###.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.#.#####
            #...#...###.....#.#.#.#.#...#...#.....#.#...#...#.#...#...#...###.#.#.#.........#.#.#...#...#.#.###.#.#.#.#...#.#...#.#.#...#.#.#.#.#...#...#
            #######.###.#####.#.#.#.#.#.#.#.#.#####.#.#######.#.#########.###.#.#.#.#########.#.#.#####.#.#.###.#.#.#.#.#.#.#####.#.#.###.#.#.#.#####.#.#
            ###...#...#.....#.#.#.#.#.#.#.#.#...#...#.......#.#.....#.....#...#...#...#...#...#.#.#...#...#.#...#.#.#...#.#...#...#.#.#...#.#.#...###.#.#
            ###.#.###.#####.#.#.#.#.#.#.#.#.###.#.#########.#.#####.#.#####.#########.#.#.#.###.#.#.#.#####.#.###.#.#####.###.#.###.#.#.###.#.###.###.#.#
            #...#.....###...#.#.#.#.#.#...#.###.#.#...#...#.#.#...#.#.>.>...#.........#.#.#.#...#...#.....#...#...#.#.....###.#.###.#.#...#.#...#...#.#.#
            #.###########.###.#.#.#.#.#####.###.#.#.#.#.#.#.#.#.#.#.###v#####.#########.#.#.#.###########.#####.###.#.#######.#.###.#.###.#.###.###.#.#.#
            #.#...#.....#.###.#.#.#.#.#.....#...#...#.#.#.#.#.#.#...###.....#.......#...#...#.#...#...###.....#...#.#.#.>.>.#.#.#...#...#.#.#...#...#.#.#
            #.#.#.#.###.#.###.#.#.#.#.#.#####.#######.#.#.#.#.#.###########.#######.#.#######.#.#.#.#.#######.###.#.#.#.#v#.#.#.#.#####.#.#.#.###.###.#.#
            #...#.#.###.#...#.#.#.#.#.#.>.>...#.....#.#.#...#...#...........#.......#.......#...#.#.#...#.....###...#...#.#.#.#.#.###...#.#...#...#...#.#
            #####.#.###.###.#.#.#.#.#.###v#####.###.#.#.#########.###########.#############.#####.#.###.#.###############.#.#.#.#.###.###.#####.###.###.#
            #...#...#...###.#.#...#.#.#...#...#.#...#...#.......#...#...#####.....#...#...#.#.....#...#.#.........#.....#.#.#.#.#...#.....###...#...#...#
            #.#.#####.#####.#.#####.#.#.###.#.#.#.#######.#####.###.#.#.#########.#.#.#.#.#.#.#######.#.#########.#.###.#.#.#.#.###.#########.###.###.###
            #.#.......#...#...#...#...#...#.#.#.#.....#...#.....###...#...#.....#.#.#.#.#.#.#...>.>.#.#.....#.....#...#.#.#...#.....###...#...#...#...###
            #.#########.#.#####.#.#######.#.#.#.#####.#.###.#############.#.###.#.#.#.#.#.#.#####v#.#.#####.#.#######.#.#.#############.#.#.###.###.#####
            #...#.....#.#.......#.......#.#.#.#.###...#...#...#...#...#...#.#...#...#...#...#...#.#.#.....#.#...###...#.#.........#.....#...###.#...#...#
            ###.#.###.#.###############.#.#.#.#.###.#####.###.#.#.#.#.#.###.#.###############.#.#.#.#####.#.###.###.###.#########.#.###########.#.###.#.#
            #...#...#...#.......#.......#...#...#...#...#.#...#.#.#.#...#...#.......#.........#...#.#.....#.#...#...###...#.....#.#.............#.....#.#
            #.#####.#####.#####.#.###############.###.#.#.#.###.#.#.#####.#########.#.#############.#.#####.#.###.#######.#.###.#.#####################.#
            #...#...#.....#...#...#####...#.....#.....#...#.....#.#...#...#.........#.......###...#...#...#.#.###.....###.#...#.#.#.........#.......#...#
            ###.#.###.#####.#.#########.#.#.###.#################.###.#.###.###############.###.#.#####.#.#.#.#######.###.###.#.#.#.#######.#.#####.#.###
            #...#.#...#.....#.......###.#.#...#.###.....#...#.....###.#.#...#.....#.....###.#...#.......#.#.#.#.....#...#...#.#.#.#.......#.#.#...#...###
            #.###.#.###.###########.###.#.###.#.###v###.#.#.#.#######.#.#.###.###.#.###.###.#.###########.#.#.#.###.###.###.#.#.#.#######.#.#.#.#.#######
            #...#.#.....#...#...#...#...#...#.#...>.>.#...#...#...###...#.....#...#...#.#...#...#.........#.#.#...#...#...#.#.#...#.......#...#.#.......#
            ###.#.#######.#.#.#.#.###.#####.#.#####v#.#########.#.#############.#####.#.#.#####.#.#########.#.###.###.###.#.#.#####.###########.#######.#
            ###...#.......#...#...###.....#.#.#.....#.#...#.....#.....#.......#...#...#.#...#...#.#.......#...###...#.....#...#...#.............#.......#
            #######.#####################.#.#.#.#####.#.#.#.#########.#.#####.###.#.###.###v#.###.#.#####.#########.###########.#.###############.#######
            ###...#.......#...###...#...#.#...#...###...#.#.....#.....#.....#.....#...#.#.>.>.#...#.#.....###...#...#...#...###.#.###.............###...#
            ###.#.#######.#.#.###.#.#.#.#.#######.#######.#####.#.#########.#########.#.#.#v###.###.#.#######.#.#.###.#.#.#.###.#.###.###############.#.#
            #...#.#...###...#...#.#.#.#...#.......#.......#...#.#.#...#...#.....#.....#.#.#...#...#.#...#...#.#.#...#.#.#.#.#...#...#.......#...#...#.#.#
            #.###.#.#.#########.#.#.#.#####.#######.#######.#.#.#.#.#.#.#.#####v#.#####.#.###.###.#.###.#.#.#.#.###.#.#.#.#.#.#####.#######.#.#.#.#.#.#.#
            #...#...#...........#.#.#.....#.......#.#...#...#.#.#.#.#.#.#.#...>.>.#.....#.###...#...#...#.#.#.#.#...#.#.#.#.#.#.....#...#...#.#.#.#...#.#
            ###.#################.#.#####.#######.#.#.#.#.###.#.#.#.#.#.#.#.###v###.#####.#####.#####.###.#.#.#.#v###.#.#.#.#.#.#####.#.#v###.#.#.#####.#
            #...#...#.....#...#...#.#...#.#.......#.#.#.#.#...#.#...#...#...###.###.#.....#...#.....#.#...#.#.#.>.>...#.#.#.#.#.....#.#.>.###.#.#.#.....#
            #.###.#.#.###.#.#v#.###.#.#.#.#.#######.#.#.#.#.###.###############.###.#.#####.#.#####.#.#.###.#.###v#####.#.#.#.#####.#.###v###.#.#.#.#####
            #.....#...###...#.>.###...#...#.......#...#...#...#.....#.........#...#.#.#.....#.......#...#...#...#...###...#...#.....#.###...#.#.#.#.#...#
            #################v###################.###########.#####.#.#######.###.#.#.#.#################.#####.###.###########.#####.#####.#.#.#.#.#.#.#
            #...###...###...#.........#...........###...#.....#.....#.......#.#...#...#.....#.....#...###.....#.###.....###...#.....#...###.#.#...#...#.#
            #.#.###.#.###.#.#########.#.#############.#.#.#####.###########.#.#.###########.#.###.#.#.#######.#.#######.###.#.#####.###.###.#.#########.#
            #.#...#.#.#...#...........#.........#...#.#.#.#...#.....#.......#.#.....#.......#.#...#.#.....###...#.......#...#.....#.#...#...#.#.........#
            #.###.#.#.#.#######################.#.#.#.#.#.#.#.#####.#.#######.#####.#.#######.#.###.#####.#######.#######.#######.#.#.###.###.#.#########
            #...#...#...#...........###.........#.#.#.#.#...#...#...#.#.....#.#.....#.......#.#.....#.....#...###...#...#.#...#...#...###.....#.........#
            ###.#########.#########.###.#########.#.#.#.#######.#.###.#.###.#.#.###########.#.#######.#####.#.#####.#.#.#.#.#.#.#######################.#
            #...#...#.....#...#.....#...#...#.....#...#.......#.#.###...###.#...#...###...#...###...#.....#.#.#...#...#...#.#.#...#...#...#.....#.....#.#
            #.###.#.#.#####.#.#.#####.###.#.#.###############.#.#.#########.#####.#.###.#.#######.#.#####.#.#.#.#.#########.#.###.#.#.#.#.#.###.#.###.#.#
            #.....#...###...#.#.....#.....#...#...#...#.......#.#.#.........#...#.#.#...#.....#...#.#...#.#.#.#.#...#.......#.....#.#.#.#.#...#.#...#...#
            #############.###.#####.###########.#.#.#.#.#######.#.#.#########.#.#.#.#.#######.#.###.#.#.#.#.#.#.###.#.#############.#.#.#.###.#.###v#####
            #...#...###...###.#.....#...........#...#...#.....#...#...........#.#.#.#.#.......#...#...#...#.#...#...#...#...###.....#.#.#...#.#.#.>.#...#
            #.#.#.#.###.#####.#.#####.###################.###.#################.#.#.#.#.#########.#########.#####.#####.#.#.###.#####.#.###.#.#.#.#v#.#.#
            #.#.#.#.#...#...#...#...#.........#...###...#.#...###.............#.#.#.#.#.#...#...#.#...#...#.#.....#...#.#.#...#...###...###.#.#...#...#.#
            #.#.#.#.#v###.#.#####.#.#########.#.#.###.#.#.#.#####.###########.#.#.#.#.#.#.#.#.#.#v#.#.#.#.#.#.#####.#.#.#.###.###.#########.#.#########.#
            #.#.#.#.#.>.#.#.#.....#...#.......#.#.....#...#.#...#...........#...#.#...#.#.#.#.#.>.>.#...#.#.#.#...#.#.#...#...###.........#.#.#.........#
            #.#.#.#.#v#.#.#.#.#######.#.#######.###########.#.#.###########.#####.#####.#.#.#.###v#######.#.#.#.#.#.#.#####v#############.#.#.#.#########
            #.#...#...#...#.#...#.....#.....###.......#.....#.#...#...#...#.#...#.....#.#.#.#.#...#...###...#...#.#.#...#.>.>.#...#...#...#...#.........#
            #.#############.###.#.#########v#########.#.#####.###.#.#.#.#.#.#.#.#####.#.#.#.#.#.###.#.###########.#.###.#.#v#.#.#.#.#.#.###############.#
            #...#.........#...#.#.......#.>.>.###.....#...#...#...#.#.#.#...#.#.#...#.#...#...#...#.#.......###...#...#...#.#.#.#...#...#.....#.....#...#
            ###.#.#######.###.#.#######.#.#v#.###.#######.#.###.###.#.#.#####.#.#.#.#.###########.#.#######.###.#####.#####.#.#.#########.###.#.###.#.###
            ###...#...#...###.#.....#...#.#.#...#.....#...#.#...###.#.#.....#.#.#.#.#.......#.....#.#.....#...#.......#.....#.#.....#...#...#...###...###
            #######.#.#.#####.#####.#.###.#.###.#####.#.###.#.#####.#.#####v#.#.#.#.#######.#.#####.#.###.###.#########.#####.#####.#.#.###.#############
            #.......#.#...#...#.....#.....#...#.#...#.#...#.#...#...#.#...>.>.#...#...#.....#.......#...#.#...###.....#.....#.....#.#.#...#.........#####
            #.#######.###.#.###.#############.#.#.#.#.###.#.###.#.###.#.###v#########.#.###############.#.#.#####.###.#####.#####.#.#.###.#########.#####
            #.....###...#.#...#...#...........#...#.#.#...#.###.#.#...#.#...#####...#...###...###.......#...#...#...#.......#...#...#...#.#...#...#.....#
            #####.#####.#.###.###.#.###############.#.#.###.###.#.#.###.#.#######.#.#######.#.###.###########.#.###.#########.#.#######.#.#.#.#.#.#####.#
            #####.....#...#...#...#.#.............#...#...#...#.#.#...#.#...###...#.....#...#...#.....#.....#.#...#.#.......#.#.....#...#...#...#.......#
            #########.#####.###.###.#.###########.#######.###.#.#.###.#.###.###.#######.#.#####.#####.#.###.#.###.#.#.#####.#.#####.#.###################
            #.........#...#.....###...#...#.......#...#...#...#...###...###.#...#.......#.....#.#.....#.#...#...#...#.#.....#.#.....#...............#...#
            #.#########.#.#############.#.#.#######.#.#.###.###############.#.###.###########.#.#.#####.#.#####.#####.#.#####.#.###################.#.#.#
            #.........#.#...#...........#.#.......#.#.#.....#...###...#.....#...#.#...#...###.#.#.....#.#.....#.#...#.#.....#.#.....#.....#.......#.#.#.#
            #########.#.###.#.###########.#######.#.#.#######.#.###.#.#.#######.#.#.#.#.#.###.#.#####v#.#####.#.#.#.#.#####.#.#####.#.###.#.#####.#.#.#.#
            #.........#.#...#.......#...#.........#.#.#.....#.#...#.#.#.....#...#.#.#.#.#.#...#.#...>.>.#.....#...#...#.....#.#.....#...#.#.....#.#...#.#
            #.#########.#.#########.#.#.###########.#.#.###.#.###.#.#.#####.#.###.#.#.#.#.#.###.#.###v###.#############.#####.#.#######.#.#####v#.#####.#
            #.........#.#.#.....###...#.#...#.....#.#...#...#.#...#.#.#.....#.###...#...#.#...#...###.#...#...#.....#...###...#.#.....#.#...#.>.#.#.....#
            #########.#.#.#.###.#######.#.#.#.###.#.#####.###.#.###.#.#.#####.###########.###.#######.#.###.#.#.###.#.#####.###.#.###.#.###.#.#v#.#.#####
            #.........#.#.#.#...#...###...#...#...#.....#...#.#.#...#.#.....#.....###...#.#...#.......#...#.#.#...#.#...#...#...#.###.#.###.#.#.#...#...#
            #.#########.#.#.#.###.#.###########.#######.###.#.#.#.###.#####.#####.###.#.#.#.###.#########.#.#.###.#.###v#.###.###.###.#.###.#.#.#####.#.#
            #.....#.....#.#.#.#...#.#.....#.....###...#.#...#.#.#.#...#...#.#...#...#.#...#.###.#...#####.#.#.#...#.#.>.>.###...#...#.#...#...#...###.#.#
            #####.#.#####.#.#.#.###.#.###.#.#######.#.#.#.###.#.#.#.###.#.#v#.#.###.#.#####.###.#.#.#####.#.#.#.###.#.#v#######.###.#.###.#######.###.#.#
            #...#.#...#...#.#.#.#...#...#.#.#.....#.#.#.#.#...#.#.#.#...#.>.>.#...#.#.....#...#...#.....#...#.#.###...#.....#...#...#...#.#...###...#.#.#
            #.#.#.###.#.###.#.#.#.#####.#.#v#.###.#.#.#.#.#.###.#.#.#.#####v#####.#.#####.###.#########.#####.#.###########.#.###.#####.#.#.#.#####.#.#.#
            #.#...#...#...#.#.#.#...#...#.>.>.###...#...#.#.#...#.#.#.....#...###...#.....#...#.........#...#...#...........#...#...###...#.#.#...#...#.#
            #.#####.#####.#.#.#.###.#.#####v#############.#.#.###.#.#####.###.#######.#####.###.#########.#.#####.#############.###.#######.#.#.#.#####.#
            #.....#...#...#.#.#.###.#...###...........#...#.#.#...#.......###.......#.......###.........#.#.#...#...........###...#.#.......#...#.......#
            #####v###.#.###.#.#.###.###.#############.#.###.#.#.###################.###################.#.#.#.#.###########.#####.#.#.###################
            #...#.>.#.#.#...#...#...#...#.............#.....#...#...................#.......###...#...#...#...#.###...#.....#...#...#...#...............#
            #.#.#v#.#.#.#.#######.###.###.#######################.###################.#####.###.#.#.#.#########.###.#.#.#####.#.#######.#.#############.#
            #.#...#...#...###...#.....###...#.........#...#.....#...................#.....#.#...#...#.....#...#.#...#...#...#.#.#...###.#.#.......#.....#
            #.###############.#.###########.#.#######.#.#.#.###.###################.#####.#.#.###########.#.#.#.#.#######.#.#.#.#.#.###.#.#.#####.#.#####
            #.#.......#.....#.#.......#.....#.###.....#.#.#...#.#...###...###...#...#.....#.#...#...#...#...#...#.........#...#...#...#...#.....#...#####
            #.#.#####.#.###.#.#######.#.#####.###.#####.#.###.#.#.#.###.#.###.#.#.###.#####.###.#.#.#.#.#############################.#########.#########
            #.#.#.....#.#...#...#.....#.....#.#...#...#.#...#.#.#.#.#...#.#...#...###...#...###...#...#.......#.....###...#.....#...#...#.....#.........#
            #.#.#.#####.#.#####.#.#########.#.#.###.#.#.###.#.#.#.#.#.###.#.###########.#.###################.#.###.###.#.#.###.#.#.###.#.###.#########.#
            #.#.#.....#.#.#.....#...#.......#.#...#.#.#...#.#.#.#.#.#...#.#...###...#...#.#...#.........#...#.#...#.....#.#.###...#.....#...#...........#
            #.#.#####.#.#.#.#######.#.#######.###.#.#.###.#.#.#.#.#.###.#.###v###.#.#.###.#.#.#.#######.#.#.#.###.#######.#.###############.#############
            #...#...#.#.#.#.#.......#...#.....###...#.#...#...#.#.#...#.#...>.>.#.#.#.#...#.#.#.....###...#...###...#...#...#...#.....#...#.............#
            #####.#.#.#.#.#.#.#########.#.###########.#.#######.#.###.#.#####v#.#.#.#.#.###.#.#####.###############.#.#.#####.#.#.###.#.#.#############.#
            #.....#...#.#...#.........#...###...#.....#.......#.#.###...#.....#.#.#.#.#...#.#.....#.......#...#...#...#...#...#.#.#...#.#.#.....###.....#
            #.#########.#############.#######.#.#.###########.#.#.#######.#####.#.#.#.###.#.#####.#######.#.#.#.#.#######.#.###.#.#.###.#.#.###.###.#####
            #...#.....#.......#.......#.......#...#...#.....#.#.#.#.......#...#...#.#.###...#.....#.......#.#.#.#...#.....#...#...#.....#.#...#.....#...#
            ###.#.###.#######.#v#######.###########.#.#.###.#.#.#.#.#######.#.#####.#.#######.#####.#######.#.#.###.#.#######.###########.###.#######.#.#
            #...#.###...#.....#.>.#...#...........#.#...###.#.#.#.#...#.....#...#...#.......#...#...###...#.#.#.#...#...#...#.#...#.......###.........#.#
            #.###.#####.#.#####v#.#.#.###########.#.#######.#.#.#.###.#.#######.#.#########.###.#.#####.#.#.#.#.#.#####.#.#.#.#.#.#.###################.#
            #...#...#...#.###...#...#...#.........#.......#...#...#...#.#.......#...#.....#.#...#...###.#.#.#.#.#.#...#.#.#.#...#.#.#.....#.....#.....#.#
            ###.###.#.###.###.#########.#.###############.#########.###.#.#########.#.###.#.#.#####.###.#.#.#.#.#.#.#.#v#.#.#####.#.#.###.#.###.#.###.#.#
            #...#...#.....#...###.......#.........#.....#...#.....#.....#.........#.#...#.#.#.....#.#...#.#.#.#.#.#.#.>.>.#.#...#.#.#...#.#...#.#...#...#
            #.###.#########.#####.###############v#.###.###.#.###.###############.#.###.#.#.#####.#v#.###.#.#.#.#.#.###v###.#.#.#.#.###.#.###.#.###v#####
            #.#...#####.....#...#...#.....#...#.>.>.###.....#.#...#...............#.....#...#####.>.>.###.#.#.#.#.#.###...#.#.#.#.#...#.#.#...#.#.>.#...#
            #.#.#######.#####.#.###.#.###.#.#.#.#v###########.#.###.###############################v#####.#.#.#.#.#.#####.#.#.#.#.###.#.#.#.###.#.#v#.#.#
            #...#...#...#.....#.#...#.###.#.#.#.#.............#...#.....#...#.......#...#...###...#...###...#.#.#.#.#...#.#.#.#.#...#.#.#.#.###...#...#.#
            #####.#.#.###.#####.#.###.###.#.#.#.#################.#####.#.#.#.#####.#.#.#.#.###.#.###.#######.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###########.#
            #...#.#.#.....#.....#...#.###...#...#...#...#...#...#.#.....#.#...#.....#.#.#.#.....#...#.......#.#.#...#.#...#...#.....#.#.#.#.#...#.......#
            #.#.#.#.#######.#######.#.###########.#.#.#.#.#.#.#.#.#.#####.#####.#####.#.#.#########.#######.#.#.#####.###############.#.#.#.#.#.#.#######
            #.#...#.###...#.......#.#...#.........#...#...#...#...#.......#.....#...#.#.#.....#...#.........#...#...#...............#.#.#...#.#.#.......#
            #.#####.###.#.#######.#.###.#.#################################.#####.#.#.#.#####.#.#.###############.#.###############.#.#.#####.#.#######.#
            #.#...#...#.#.........#...#.#...#...........###.....#...#.....#.......#...#.....#...#...........#...#.#.................#...#.....#.........#
            #.#.#.###.#.#############.#.###.#.#########.###.###.#.#.#.###.#################.###############.#.#.#.#######################.###############
            #...#.#...#.............#...#...#.#.......#...#.#...#.#.#...#.#.......#...#...#.#...............#.#.#...#.......#.....###...#.....#.........#
            #####.#.###############.#####.###.#.#####.###.#.#.###.#.###.#.#.#####.#.#.#.#.#.#.###############.#.###.#.#####.#.###.###.#.#####.#.#######.#
            #.....#...#...#...#...#...###.....#.....#.#...#.#...#.#.....#...#...#...#...#...#...............#.#.###...###...#...#...#.#.#...#...#.......#
            #.#######.#.#.#.#.#.#.###.#############.#.#.###.###.#.###########.#.###########################.#.#.#########.#####.###.#.#.#.#.#####v#######
            #...#...#...#...#.#.#.....#...#.........#.#.###.#...#.............#.....###...#...#.............#.#.#...#.....#...#...#...#.#.#.#...>.#...###
            ###.#.#.#########.#.#######.#.#.#########.#.###.#.#####################.###.#.#.#.#.#############.#.#.#.#.#####.#.###.#####.#.#.#.###v#.#.###
            #...#.#.#.......#...#...#...#...#.....###...#...#...#...........###...#.#...#...#.#.....#.....###.#.#.#.#.....#.#.#...#.....#.#.#.#...#.#.###
            #.###.#.#.#####.#####.#.#.#######.###.#######.#####.#.#########.###.#.#.#.#######.#####.#.###.###.#.#.#.#####.#.#.#.###.#####.#.#.#.###.#.###
            #.#...#...#...#.......#.#.........###...#...#.#.....#.........#.....#...#.......#.......#.#...#...#.#.#.#...#.#.#.#...#.#...#.#.#.#.#...#...#
            #.#.#######.#.#########.###############.#.#.#.#.#############.#################.#########.#.###.###.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#####.#
            #.#.#.......#...........#.......#.......#.#...#.#...#...#...#.........###...###.......#...#.#...#...#.#.#.#.#.#.#.#...#...#.#.#...#.#.#.....#
            #.#.#.###################.#####.#.#######.#####.#.#.#.#.#.#.#########.###.#.#########.#.###.#.###.###.#.#.#.#v#.#.#.#######.#.#####.#.#.#####
            #...#.............#...#...#.....#.....###...#...#.#.#.#.#.#.#...###...#...#.#.....#...#.#...#...#.#...#.#.#.>.>.#.#.....#...#.....#.#.#.#...#
            #################.#.#.#.###.#########.#####.#.###.#.#.#.#.#.#.#.###v###.###.#.###.#.###.#.#####.#.#.###.#.#######.#####.#.#######.#.#.#.#.#.#
            #.................#.#.#.#...###...###.#...#.#.#...#.#.#.#.#.#.#.#.>.>.#.#...#...#.#...#.#.#...#.#.#...#.#.###...#...#...#...#.....#...#...#.#
            #.#################.#.#.#.#####.#.###v#.#.#.#.#.###.#.#.#.#.#.#.#.###.#.#.#####.#.###v#.#.#.#.#.#.###.#.#.###.#.###.#.#####.#.#############.#
            #...#.....#...#...#.#.#.#...#...#.#.>.>.#.#.#.#...#.#.#.#.#.#.#.#.###.#.#.#...#.#.#.>.>.#.#.#.#.#.#...#.#.....#.#...#.#.....#...#...........#
            ###.#.###.#.#.#.#.#.#.#.###.#.###.#.#####.#.#.###.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.#.#.#.###.#######.#.###.#.#######.#.###########
            ###...###...#...#...#...###...###...#####...#.....#...#...#...#...###...#...#...#...#####...#...#...###.........#.....#.........#...........#
            ###########################################################################################################################################.#
    """.trimIndent()
    )
    check(6302, result)
}

private fun test(input: String): Int {
    val map = input.split("\n")
    val width = map[0].length
    val height = map.size
    val cols = 0 until width
    val rows = 0 until height
    val startPoint = Point(1, 0)
    val endPoint = Point(width - 2, height - 1)
    fun value(p: Point) = map[p.y][p.x]

    val permitted = setOf('.', '>', 'v')
    fun Point.check(previous: List<Point>) = x in cols && y in rows
            && value(this) in permitted
            && this !in previous

    val points = listOf(Point(-1, 0), Point(0, -1), Point(1, 0), Point(0, 1))
    fun Point.next(previous: List<Point>): List<Point> {
        val result = mutableListOf<Point>()
        for (p in points) {
            val newP = plus(p)
            if (newP.check(previous)) {
                result += newP
            }
        }
        return result
    }

    var max = 0
    fun dfs(currentPath: List<Point>) {
        if (currentPath.last() == endPoint) {
            max = kotlin.math.max(max, currentPath.size - 1)

            println("path ${currentPath.size} steps long")
            println("current max is $max")
        } else {
            val next = currentPath.last().next(currentPath)
            for (nextPoint in next) {
                val newPath = mutableListOf<Point>()
                newPath += currentPath
                newPath += nextPoint
                dfs(newPath)
            }
        }
    }

    val currentPath = mutableListOf<Point>()
    currentPath += startPoint
    dfs(currentPath)
    return max
}
